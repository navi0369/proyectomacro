### f53c98c – se sincronizaron la mayoria de elementos .ipynb, justo despues de esto sincronizaremos minerales. Esto puede ocasionar problemas por eso el commit actual (2025-06-22)

diff --git a/notebooks/tesis/serie_completa/exportaciones/evolucion_hidrocarburos.py b/notebooks/tesis/serie_completa/exportaciones/evolucion_hidrocarburos.py
deleted file mode 100644
index 0ae2a0e..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/evolucion_hidrocarburos.py
+++ /dev/null
@@ -1,180 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-
-# ── 0. Imports ───────────────────────────────────────────────────────
-import os, sqlite3
-import pandas as pd
-import matplotlib.pyplot as plt
-import sys
-sys.path.append(os.path.abspath('../'))          # ruta a graficos_utils.py
-from graficos_utils import (
-    add_hitos,
-    add_cycle_means_multi,
-    add_year_value_annotations,
-    add_period_growth_annotations_multi,
-    add_participation_cycle_boxes
-)
-
-# ── 1. Configuración general ─────────────────────────────────────────
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family":"serif", "font.size":12,
-    "axes.titlesize":16,   "axes.labelsize":14,
-    "grid.linestyle":"--", "lines.linewidth":2,
-    "figure.dpi":150,      "savefig.bbox":"tight",
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = (pd.read_sql(
-            "SELECT * FROM exportaciones_tradicionales_hidrocarburos",
-            conn, index_col="año")
-          .sort_index())                 # 1992-2024, millones USD
-
-# ── 3. Series, colores, abreviaturas ─────────────────────────────────
-series = [
-    ("hidrocarburos",     "Total hidrocarburos"),
-    ("gas_natural",       "Gas natural"),
-    ("otros_hidrocarburos","Otros hidrocarburos"),
-]
-cmap     = plt.get_cmap("tab10")
-colors   = {col: cmap(i) for i, (col, _) in enumerate(series)}
-abbr_map = {"hidrocarburos":"Tot", "gas_natural":"GN", "otros_hidrocarburos":"OH"}
-cols     = [c for c,_ in series]
-
-# ── 4. Ciclos y estadísticas ─────────────────────────────────────────
-period_slices = {
-    "Expansión 92-99": slice(1992, 1999),
-    "Crisis 00-05": slice(2000, 2005),
-    "Acumulación 06-13": slice(2006, 2013),
-    "Recesión 14-24":  slice(2014, 2024),
-}
-cycle_stats = {name: df.loc[slc].mean().to_dict()
-               for name, slc in period_slices.items()}
-
-# Posiciones para los cuadros de medias
-y_max = df[cols[0]].max()
-cycle_offsets = {
-    "Expansión 92-99":   (1995, 0.85),
-    "Crisis 00-05": (2001, 0.95),
-    "Acumulación 06-13": (2006, 0.95),
-    "Recesión 14-24":    (2018, 0.95),
-}
-
-# ── 5. Hitos y anotaciones de valor ──────────────────────────────────
-hitos_v = {
-    2000: "Crisis",
-    2006: "Expansión",
-    2014: "Recesión"
-}
-hitos_offset = {a:0.67 for a in hitos_v}
-
-anot_years = [1992, 2000, 2006, 2008, 2014, 2018, 2024]
-annotation_offsets = {
-    "hidrocarburos": {
-        1992:(0,150), 2000:(0,150), 2006:(0,230),
-        2008:(0,150), 2014:(0,150), 2018:(0,150), 2024:(1,150),
-    },
-    "gas_natural": {
-        1992:(0,500), 2000:(0,500), 2006:(.5,-500),
-        2008:(0,-1000), 2014:(1.2,0), 2018:(0,-500), 2024:(0,-250),
-    },
-    "otros_hidrocarburos": {
-        1992:(0,-220), 2000:(0,-220), 2006:(0,-220),
-        2008:(0,-220), 2014:(0,-320), 2018:(0,-220), 2024:(0,-220),
-    },
-}
-
-# ── 6. Periodos de crecimiento (%) ───────────────────────────────────
-growth_periods = [(1992,2000), (2000,2006), (2006,2014), (2014,2024)]
-growth_offsets = {
-    "1992-2000": (1995, 0.70),
-    "2000-2006": (2001, 0.82),
-    "2006-2014": (2006, 0.82),
-    "2014-2024": (2018, 0.82),
-}
-
-# ── 7. Gráfico ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(13,8))
-
-for i,(col,label) in enumerate(series):
-    ax.plot(df.index, df[col], label=label, color=colors[col])
-
-# 7.1 Hitos verticales
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-
-# 7.2 Medias de ciclo
-add_cycle_means_multi(
-    ax, cycle_stats, cycle_offsets,
-    abbr_map, colors,
-    line_spacing=y_max*0.03
-)
-
-# 7.3 Valores puntuales
-add_year_value_annotations(
-    ax, df, anot_years,
-    cols, annotation_offsets,
-    colors, arrow_lw=0.6
-)
-
-# 7.4 Tasas de crecimiento entre tramos
-add_period_growth_annotations_multi(
-    ax, df, growth_periods,
-    cols, growth_offsets,
-    colors, abbr_map
-)
-
-
-components = ["gas_natural", "otros_hidrocarburos"]
-total_col  = "hidrocarburos"
-participation_periods = [
-    (1992, 1999),
-    (2000, 2005),
-    (2006, 2013),
-    (2014, 2024),
-]
-participation_offsets = {
-    "1992-1999": (1995, 0.56),
-    "2000-2005": (2001, 0.68),
-    "2006-2013": (2006, 0.68),
-    "2014-2024": (2018, 0.68),
-}
-# 8.6 Cuadros de participación media
-add_participation_cycle_boxes(
-    ax, df, participation_periods,
-    components, total_col,
-    participation_offsets,
-    abbr_map=abbr_map,
-    colors={c: colors[c] for c in components}
-)
-
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"Exportaciones Tradicionales de Hidrocarburos ({df.index[0]}–{df.index[-1]})",
-             fontweight="bold")
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de dólares (USD)")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis="x", rotation=45)
-ax.legend(loc="upper left", fontsize=12)
-
-plt.tight_layout()
-plt.savefig(os.path.join(OUTPUT_DIR,
-            "exportaciones_tradicionales_hidrocarburos.png"),
-            dpi=300)
-plt.show()
diff --git a/notebooks/tesis/serie_completa/exportaciones/exportacion_gas_natural_por_contrato.py b/notebooks/tesis/serie_completa/exportaciones/exportacion_gas_natural_por_contrato.py
deleted file mode 100644
index 8beaebe..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/exportacion_gas_natural_por_contrato.py
+++ /dev/null
@@ -1,187 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import sys
-import matplotlib.pyplot as plt
-import sqlite3, os
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_participation_cycle_boxes, add_cycle_means_multi, add_hitos,
-    add_period_growth_annotations_multi, add_year_value_annotations
-)
-# ── 1. Configuración general ─────────────────────────────────────────
-output_dir = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(output_dir, exist_ok=True)
-
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16,  "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150,     "savefig.bbox": "tight"
-})
-periods = {
-    "Expansión 56-69":   slice(1956, 1969),
-    "Recesión 70-81":    slice(1970, 1981),
-    "Expansión 86-99":   slice(1986, 1999),
-    "Crisis 00-05":      slice(2000, 2005),
-    "Expansión 06-13":   slice(2006, 2013),
-    "Recesión 14-24":    slice(2014, 2024),
-}
-periodos_growth = [
-    (2006, 2013),  # Expansión 06-13
-    (2014, 2023),  # Recesión 14-24
-]
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df_raw = pd.read_sql(
-        "SELECT año, destino, monto FROM exportacion_gas_natural_contratos",
-        conn
-    )
-    
-
-# 2.1 Agrupar por destino
-df = (df_raw.groupby(['año', 'destino'])['monto']
-                .sum()
-                .unstack(fill_value=0)
-                .sort_index())
-df['total']=df.sum(axis=1)
-
-#estadisticas
-cycle_stats = {
-    name: df.loc[period].mean().to_dict()
-    for name, period in periods.items()
-}
-
-componentes = [
-    ("Argentina", "Argentina"),
-    ("Brasil", "Brasil"),
-    ("total", "Total"),
-]
-colors = {
-    "Argentina": "#1f77b4",  # azul
-    "Brasil":    "#ff7f0e",  # naranja
-    "total":     "#2ca02c",  # verde
-}
-abbr_map = {
-    "Argentina": "Arg",
-    "Brasil":    "Bra",
-    "total":     "Tot",
-}
-# ── 3. Hitos y anotaciones ──────────────────────────────────────────
-hitos_v = {2000:"Crisis", 2006:"Expansion", 2014:"Recesion"}
-anot_years = [1992, 2000, 2006, 2008, 2014, 2023]
-annotation_offsets = {
-    "Argentina": {
-        1992: (0,   100),
-        2000: (0,  -100),
-        2006: (0,   100),
-        2008: (0,  100),
-        2014: (0,   150),
-        2023: (-0.3,   -160),
-    },
-    "Brasil": {
-        1992: ( 0,   -100),
-        2000: ( 0,   100),
-        2006: ( 0,  -400),
-        2008: ( 0,  400),
-        2014: ( 0,   250),
-        2023: ( 0.3,  -120),
-    },
-    "total": {
-        1992: (0,   300),
-        2000: (0,  300),
-        2006: (0,   300),
-        2008: (0,  300),
-        2014: (0,   150),
-        2023: (-0.3,   -160),
-    },
-}
-medias_offset = {
-    "Expansión 86-99": (1995, 0.97),
-    "Expansión 06-13": (2006, 0.97),
-    "Crisis 00-05":    (2002, 0.97),
-    "Recesión 14-24":  (2016, 0.97),
-}
-growth_offsets = {
-    "2006-2013": (2006, 0.81),  
-    "2014-2023": (2016, 0.81),        
-}
-hitos_offset={}
-participation_offsets = {
-    "2006-2013": (2006, 0.66),
-    "2014-2023": (2016, 0.66),
-}
-# ── 4. Gráfico ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(13, 8))
-cmap = plt.get_cmap("tab10")
-
-for col, _ in componentes:
-    ax.plot(df.index, df[col],
-            label=col, color=colors[col])
-#hitos
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-
-# ── 6. Anotaciones en años clave ─────────────────────────────────────
-
-columnas=[col for col, _ in componentes]
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03
-add_cycle_means_multi(ax, cycle_stats, medias_offset, abbr_map, colors, line_spacing)
-
-add_period_growth_annotations_multi(
-    ax,
-    df,
-    periodos_growth,
-    columnas,
-    growth_offsets,
-    colors,
-    abbr_map,
-    fmt="{vi}→{vf}: {tasa}%",
-)
-add_year_value_annotations(ax, df, anot_years, columnas, annotation_offsets, colors,arrow_lw=0.8)
-
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos_growth,
-    ["Argentina", "Brasil"],
-    "total",
-    participation_offsets,
-    abbr_map,
-    colors,
-)
-
-
-# ── 7. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"Evolución de Exportaciones de Gas Natural por contrato ({df.index[0]}–{df.index[-1]})",
-             fontweight="bold")
-ax.set_xlabel("Año")
-ax.set_ylabel("Monto (millones USD)")
-ax.set_xticks(df.index[::max(1, len(df)//31)])
-ax.tick_params(axis="x", rotation=45)
-
-# leyenda solo de las lineplots
-handles = [h for h in ax.get_lines() if not h.get_label().startswith('_')]
-ax.legend(handles, [h.get_label() for h in handles],
-          title="Destino", loc="upper left", fontsize=12.6)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "gas_natural_por_destino.png"), dpi=300)
-plt.show()
-
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/exportaciones.py b/notebooks/tesis/serie_completa/exportaciones/exportaciones.py
deleted file mode 100644
index 50a0269..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/exportaciones.py
+++ /dev/null
@@ -1,163 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import sys
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-from matplotlib.lines import Line2D
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi, add_participation_cycle_boxes
-)
-
-# ── 0.  Tramos de ciclo (consistentes con el resto de la tesis) ───────
-CRISIS_82_85      = slice(1982, 1985)   # Crisis (neoliberal)
-EXPANSION_86_99   = slice(1986, 1999)   # Expansión
-CRISIS_00_05      = slice(2000, 2005)   # Crisis
-ACUMULACION_06_13 = slice(2006, 2013)   # Acumulación
-RECESION_14_24    = slice(2014, 2024)   # Recesión
-
-periods = {
-    "Expansión 86-99": EXPANSION_86_99,
-    "Expansión 06-13": ACUMULACION_06_13,
-    "Crisis 00-05": CRISIS_00_05,
-    "Recesión 14-24":  RECESION_14_24,
-}
-
-# ── 1. Configuración general ─────────────────────────────────────────
-output_dir = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(output_dir, exist_ok=True)
-
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family': 'serif', 'font.size': 12,
-    'axes.titlesize': 16,   'axes.labelsize': 14,
-    'grid.linestyle': '--', 'lines.linewidth': 2,
-    'figure.dpi': 150,      'savefig.bbox': 'tight'
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
-    df = (pd.read_sql('SELECT * FROM exportaciones_tradicionales_no_tradicionales', conn)
-            .set_index('año')
-            .sort_index())
-    df['exportaciones'] = df['tradicionales'] + df['no_tradicionales']
-
-# ── 3. Estadísticas por ciclo ────────────────────────────────────────
-cycle_stats = {
-    name: df.loc[period].mean().to_dict()
-    for name, period in periods.items()
-}
-
-# ── 4. Hitos, años clave, offsets ────────────────────────────────────
-hitos_v = {
-    1982: "Crisis", 1986: "Expansión", 2000: "Crisis",
-    2006: "Expansión", 2014: "Recesión"
-}
-hitos_offset = {a: 0.8 for a in hitos_v}
-
-medias_offset = {
-    "Expansión 86-99": (1988, 1.05),
-    "Crisis 00-05": (2000, 1.05),
-    "Expansión 06-13": (2006, 1.05),
-    "Recesión 14-24":  (2016, 1.05),
-}
-
-anot_years = [1982, 1986, 2000, 2006, 2014, 2024]
-annotation_offsets = {
-    'exportaciones':     {
-        1982: (0,  800), 1986: (0,  800), 2000: (0,  800),
-        2006: (0,  1000), 2014: (0,  400), 2024: (0,  -400),
-    },
-    'tradicionales':     {
-        1982: (0,  400), 1986: (0,  400), 2000: (0,  900),
-        2006: (0,  -1500), 2014: (-1,  -1500), 2024: (0,  -400),
-    },
-    'no_tradicionales':  {
-        1982: (0, -350), 1986: (0, -350), 2000: (0, -450),
-        2006: (0, -500), 2014: (0, -700), 2024: (0, -500),
-    },
-}
-
-annotation_tasas_offsets = {
-    "1986-2006": (1988, 0.91),
-    "2000-2005": (2000, 0.91),
-    "2006-2014": (2006, 0.91),
-    "2014-2024": (2016, 0.91),
-}
-
-participation_offsets = {
-    "1986-2006": (1988, 0.77),   
-    "2000-2005": (2000, 0.77),
-    "2006-2014": (2006, 0.77),
-    "2014-2024": (2016, 0.77),
-}
-
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15, 8))
-
-ax.plot(df.index, df['tradicionales'],
-        label='Tradicionales',      color='#1f77b4')
-ax.plot(df.index, df['no_tradicionales'],
-        label='No tradicionales',   color='#2ca02c')
-ax.plot(df.index, df['exportaciones'],
-        label='Exportaciones (total)',      color='#ff7f0e')
-
-# ── 6. Hitos ─────────────────────────────────────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset, line_kwargs={'linewidth':0.9})
-
-# ── 7. Anotaciones de medias, valores y tasas ────────────────────────
-abbr_map = {'tradicionales': 'Trad', 'no_tradicionales': 'NoTrad', 'exportaciones': 'X'}
-component_colors = {'tradicionales': '#1f77b4', 'no_tradicionales': '#2ca02c', 'exportaciones': '#ff7f0e'}
-
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03
-cols = ['tradicionales', 'no_tradicionales', 'exportaciones']
-
-add_cycle_means_multi(ax, cycle_stats, medias_offset,
-                      abbr_map, component_colors, line_spacing)
-
-add_year_value_annotations(ax, df, anot_years,
-                           cols, annotation_offsets, component_colors, arrow_lw=0.5)
-
-periodos = [(1986, 2006), (2000, 2005), (2006, 2014), (2014, 2024)]
-add_period_growth_annotations_multi(ax, df, periodos,
-    cols, annotation_tasas_offsets, component_colors, abbr_map)
-
-add_participation_cycle_boxes(
-    ax, df, periodos,
-    ['tradicionales', 'no_tradicionales'], #columnas
-    'exportaciones',
-    participation_offsets,
-    abbr_map=abbr_map,
-    colors=component_colors
-)
-
-ax.set_ylim(-600, y_max + 1000)
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"Exportaciones Tradicionales vs. No Tradicionales ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de dólares")
-ax.set_xticks(df.index[::max(1, len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', fontsize=14)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "exportaciones_tradicionales_no_tradicionales.png"))
-plt.show()
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/exportaciones_no_tradicionales.py b/notebooks/tesis/serie_completa/exportaciones/exportaciones_no_tradicionales.py
deleted file mode 100644
index 9c0c7ec..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/exportaciones_no_tradicionales.py
+++ /dev/null
@@ -1,193 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import sys
-import matplotlib.pyplot as plt
-import sqlite3, os
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_participation_cycle_boxes, add_cycle_means_multi, add_hitos,
-    add_period_growth_annotations_multi, add_year_value_annotations
-)
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql(
-        "SELECT *FROM exportaciones_no_tradicionales",
-        conn
-    )
-prod_cols = [c for c in df.columns if c not in ('año', 'total')]
-totales = df.set_index('año')[prod_cols].sum().sort_values(ascending=False)
-
-# Imprimimos top‐5
-print("Top 5 productos por valor total exportado (sin incluir 'total'):")
-print(totales.head(5))
-
-# ── 4. Gráfica de los 5 principales ────────────────────────────────
-fig, ax = plt.subplots(figsize=(8,4))
-totales.head(5).plot.bar(ax=ax)
-ax.set_title("Top 5 Exportaciones No Tradicionales (1992–2024)")
-ax.set_ylabel("Millones de dólares")
-ax.set_xlabel("Producto")
-plt.xticks(rotation=45, ha="right")
-plt.tight_layout()
-plt.show()
-
-# %%
-"""
-Exportaciones No Tradicionales: soya, ‘otros’ y castaña  
-(1992-2024, Millones USD) — gráfico con helpers de *graficos_utils*
-"""
-
-# ── 0. Imports ───────────────────────────────────────────────────────
-import os, sqlite3, sys
-import pandas as pd
-import matplotlib.pyplot as plt
-
-sys.path.append(os.path.abspath('../'))          # ruta a graficos_utils.py
-from graficos_utils import (
-    add_hitos,
-    add_cycle_means_multi,
-    add_year_value_annotations,
-    add_period_growth_annotations_multi,
-    add_participation_cycle_boxes,
-)
-
-# ── 1. Configuración general ─────────────────────────────────────────
-OUT = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUT, exist_ok=True)
-
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family":"serif", "font.size":12,
-    "axes.titlesize":16,   "axes.labelsize":14,
-    "grid.linestyle":"--", "lines.linewidth":2,
-    "figure.dpi":150,      "savefig.bbox":"tight",
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = (pd.read_sql("SELECT * FROM exportaciones_no_tradicionales",
-                      conn, index_col="año")
-            .sort_index())                 # 1992–2024
-
-# aseguramos nombres coherentes ↓ (ajusta si tus columnas difieren)
-df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_')
-
-series = [
-    ("soya",          "Soya"),
-    ("otros","Otros"),     # «otros_productos» en la base
-    ("castaña",       "Castaña"),
-]
-cols  = [c for c,_ in series]
-cmap  = plt.get_cmap("tab10")
-colors= {col: cmap(i) for i,(col,_) in enumerate(series)}
-abbr  = {"soya":"Soy", "castaña":"Cas", "otros_productos":"Otr"}
-
-# ── 3. Ciclos ────────────────────────────────────────────────────────
-periods_for_means=[
-    (1992, 1999),
-    (2000, 2005),
-    (2006, 2013),
-    (2014, 2024),
-]
-periods = [
-    (1992, 2000),    # sub-expansión 92-99
-    (2000, 2005),    # crisis
-    (2006, 2013),    # acumulación
-    (2014, 2024),    # recesión
-]
-cycle_stats = {f"{vi}-{vf}": df.loc[vi:vf, cols].mean().to_dict()
-               for vi,vf in periods_for_means}
-cycle_offsets = {
-    "1992-1999": (1996, 0.99),
-    "2000-2005": (2002, 0.99),
-    "2006-2013": (2009, 0.99),
-    "2014-2024": (2018, 0.99),
-}
-
-# ── 4. Hitos, valores y crecimientos ─────────────────────────────────
-hitos_v      = {2000: "Crisis", 2006: "Expansión", 2014: "Recesión"}
-hitos_offset = {a:0.5 for a in hitos_v}
-
-anot_years = [1992, 2000, 2006, 2014, 2024]
-annotation_offsets = {
-    "soya": {
-        1992:(0,112), 2000:(0,50), 2006:(0,50),
-        2014:(0.5,50), 2024:(1,50),
-    },
-    "otros": {
-        1992:(0,75),2000:(0,-60),2006:(0,-70),
-        2014:(-0.5,-50),2024:(0.5,-80),
-    },
-    "castaña": {
-        1992:(0,-40),  2000:(0,-50),  2006:(0,-50),
-        2014:(0,60),  2024:(0,60),
-    },
-}
-
-growth_periods = periods
-growth_offsets = {
-    "1992-2000": (1996, 0.86),
-    "2000-2005": (2002, 0.86),
-    "2006-2013": (2009, 0.86),
-    "2014-2024": (2018, 0.86),
-}
-
-# ── 5. Participación media (%) ───────────────────────────────────────
-components   = ["soya", "castaña"]
-total_col    = "total"       # en la tabla existe ‘total’
-part_offsets = {
-    "1992-2000": (1996, 0.7),
-    "2000-2005": (2002, 0.7),
-    "2006-2013": (2009, 0.7),
-    "2014-2024": (2018, 0.7),
-}
-
-# ── 6. Gráfico ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(13,8))
-
-for col,label in series:
-    ax.plot(df.index, df[col], label=label, color=colors[col])
-
-# helpers
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-add_cycle_means_multi(ax, cycle_stats, cycle_offsets,
-                      abbr, colors, line_spacing=df[cols[0]].max()*0.03)
-add_year_value_annotations(ax, df, anot_years,
-                           cols, annotation_offsets, colors, arrow_lw=0.6)
-add_period_growth_annotations_multi(ax, df, growth_periods,
-                                    cols, growth_offsets, colors, abbr)
-add_participation_cycle_boxes(
-    ax, df, growth_periods, components, total_col,
-    part_offsets, abbr_map=abbr,
-    colors={c: colors[c] for c in components}
-)
-
-# ── 7. Etiquetas y salida ────────────────────────────────────────────
-ax.set_title("Exportaciones No Tradicionales: Soya, ‘Otros’ y Castaña (1992-2024)",
-             fontweight="bold")
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de USD")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis="x", rotation=45)
-ax.legend(loc="upper left", fontsize=12)
-
-plt.tight_layout()
-plt.savefig(os.path.join(OUT, "exportaciones_no_tradicionales_soya_otros_castaña.png"),
-            dpi=300)
-plt.show()
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/exportaciones_tradicionales.py b/notebooks/tesis/serie_completa/exportaciones/exportaciones_tradicionales.py
deleted file mode 100644
index f143d16..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/exportaciones_tradicionales.py
+++ /dev/null
@@ -1,168 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import sys
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi, add_participation_cycle_boxes
-)
-
-# ── 0.  Tramos de ciclo ──────────────────────────────────────────────
-EXPANSION_86_99   = slice(1986, 1999)
-ACUMULACION_06_13 = slice(2006, 2013)
-RECESION_14_24    = slice(2014, 2024)
-
-periods = {
-    "Expansión 86-99": EXPANSION_86_99,
-    "Crisis 00-05": slice(2000, 2005),
-    "Expansión 06-13": ACUMULACION_06_13,
-    "Recesión 14-24":  RECESION_14_24,
-}
-
-# ── 1. Configuración general ─────────────────────────────────────────
-output_dir = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(output_dir, exist_ok=True)
-
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family': 'serif', 'font.size': 12,
-    'axes.titlesize': 16,   'axes.labelsize': 14,
-    'grid.linestyle': '--', 'lines.linewidth': 2,
-    'figure.dpi': 150,      'savefig.bbox': 'tight'
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
-    df = (pd.read_sql('SELECT * FROM exportaciones_tradicionales', conn)
-            .set_index('año')
-            .sort_index())
-    df['total'] = df['minerales'] + df['hidrocarburos']
-# ── 3. Estadísticas por ciclo ────────────────────────────────────────
-cycle_stats = {
-    name: df.loc[period].mean().to_dict()
-    for name, period in periods.items()
-}
-
-# ── 4. Hitos, años clave, offsets ────────────────────────────────────
-hitos_v = {
-    1952: "Crisis", 1956: "Expansión", 1970: "Recesión",
-    1982: "Crisis", 1986: "Expansión", 2002: "Crisis",
-    2006: "Expansión", 2014: "Recesión"
-}
-hitos_offset = {a: 0.8 for a in hitos_v}          # igual que antes
-medias_offset = {
-    "Expansión 86-99": (1992, 0.86),
-    "Crisis 00-05": (2002, 1.0),
-    "Expansión 06-13": (2006, 1.0),
-    "Recesión 14-24":  (2016, 1.0),
-}
-
-anot_years = [1992, 2000, 2006, 2014, 2024]
-annotation_offsets = {
-    'minerales':     {
-        1992: (0, 300),
-        2000: (0, 350),
-        2006: (0, -650),
-        2014: (0, 300),
-        2024: (0, -300),
-    },
-    'hidrocarburos': {
-        1992: (0, -350),
-        2000: (0, -290),
-        2006: (0, -590),
-        2014: (0, 300),
-        2024: (0, -300),
-    },
-    'total':         {
-        1992: (0, 600),
-        2000: (0, 500),
-        2006: (0, 600),
-        2014: (0, 100),
-        2024: (0, -200),
-    }
-}
-
-annotation_tasas_offsets = {
-    "1992-1999": (1992, 0.70),
-    "2000-2005": (2002, 0.85),
-    "2006-2013": (2006, 0.85),
-    "2014-2024": (2016, 0.85),
-}
-participation_offsets = {
-    "1992-1999": (1992, 0.55),
-    "2000-2005": (2002, 0.7),
-    "2006-2013": (2006, 0.7),
-    "2014-2024": (2016, 0.16),
-}
-
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15, 8))
-
-ax.plot(df.index, df['minerales'],
-        label='Minerales',    color='#1f77b4')
-ax.plot(df.index, df['hidrocarburos'],
-        label='Hidrocarburos', color='#ff7f0e')
-
-ax.plot(df.index, df['total'],
-        label='Total tradicionales', color='#2ca02c')
-
-# ── 6. Hitos ─────────────────────────────────────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-
-# ── 7. Anotaciones de medias, valores y tasas ────────────────────────
-abbr_map = {'minerales': 'Min', 'hidrocarburos': 'Hc', 'total': 'Tot'}
-component_colors = {'minerales': '#1f77b4', 'hidrocarburos': '#ff7f0e', 'total': '#2ca02c'}
-
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03
-cols = ['minerales', 'hidrocarburos', 'total']
-
-add_cycle_means_multi(ax, cycle_stats, medias_offset,
-                      abbr_map, component_colors, line_spacing)
-
-add_year_value_annotations(ax, df, anot_years,
-                           cols, annotation_offsets, component_colors, arrow_lw=0.7)
-
-periodos = [(1992, 1999), (2000, 2005), (2006, 2013), (2014, 2024)]
-add_period_growth_annotations_multi(ax, df, periodos,
-    cols, annotation_tasas_offsets, component_colors, abbr_map)
-
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos,
-    ['minerales', 'hidrocarburos'],  # sólo minerales e hidrocarburos
-    'total',                   # columna total sobre la que se calcula %
-    participation_offsets,
-    abbr_map=abbr_map,
-    colors=component_colors
-)
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"Exportaciones Tradicionales: Minerales vs. Hidrocarburos ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de dólares")
-ax.set_xticks(df.index[::max(1, len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', fontsize=12)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "exportaciones_tradicionales.png"))
-plt.show()
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/gas_natural_valor_y_precio.py b/notebooks/tesis/serie_completa/exportaciones/gas_natural_valor_y_precio.py
deleted file mode 100644
index 31377c5..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/gas_natural_valor_y_precio.py
+++ /dev/null
@@ -1,316 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-"""
-Gas natural: Valor exportado vs. precio (1987-2023)
-Versión que usa *exclusivamente* los helpers de graficos_utils
-y oculta las entradas «_child…» de la leyenda.
-"""
-
-# ── 0. Imports ───────────────────────────────────────────────────────
-import sys, os, sqlite3
-import pandas as pd
-import matplotlib.pyplot as plt
-
-# helpers propios
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_hitos,
-    add_cycle_means_multi,
-    add_year_value_annotations,
-    add_period_growth_annotations_multi,
-    add_participation_cycle_boxes,   # (no se usa aquí, pero disponible)
-)
-
-# ── 1. Configuración general ─────────────────────────────────────────
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16,   "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150,      "savefig.bbox": "tight",
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = (pd.read_sql("SELECT año,valor,precio_usd_mpc FROM exportacion_gas_natural", conn,
-                      index_col="año")
-            .sort_index())              # 1987-2024
-
-df["valor_musd"] = df["valor"] / 1_000     # miles USD → millones
-df.drop(columns="valor", inplace=True)
-# ── 3. Ciclos y estadísticas ─────────────────────────────────────────
-periods = {
-    "Expansión 86-99": slice(1986, 1999),
-    "Crisis 00-05":    slice(2000, 2005),
-    "Expansión 06-13": slice(2006, 2013),
-    "Recesión 14-24":  slice(2014, 2024),
-}
-cycle_stats = {name: df.loc[s].mean().to_dict() for name, s in periods.items()}
-
-# ── 4. Series, colores y abreviaturas ────────────────────────────────
-cols   = ["valor_musd", "precio_usd_MPC"]
-abbr   = {"valor_musd": "Valor", "precio_usd_MPC": "Precio"}
-colors = {"valor_musd": "#1f77b4", "precio_usd_MPC": "#d62728"}
-
-# ── 5. Hitos y offsets ───────────────────────────────────────────────
-hitos_v = {
-    2000: "Crisis",
-    2006: "Expansión",
-    2014: "Recesión"
-}
-hitos_offset = {2000: .59, 2006: .62, 2014: .48}
-
-anot_years = [1987, 2000, 2006, 2014, 2023]
-annotation_offsets = {
-    "valor_musd": {
-        1987: (0, -240),
-        2000: (0, -240),
-        2006: (0, 500),
-        2013: (0, 100),
-        2014: (0, 100),
-        2023: (0, -300),
-    },
-    "precio_usd_MPC": {
-        1987: (0, 0.3),
-        2000: (0, 0.3),
-        2006: (0, 0.34),
-        2013: (0, -2),
-        2014: (0, 0),
-        2023: (0, -0.3),
-    },
-}
-
-growth_periods = [(1987,2006), (2000,2005), (2006,2014), (2014,2023)]
-period_growth_offsets = {
-    "1987-2006": (1988, 0.75),
-    "2000-2005": (2000, 0.75),
-    "2006-2014": (2006, 0.75),
-    "2014-2023": (2016, 0.75),
-}
-
-
-# ── 6. Gráfico ───────────────────────────────────────────────────────
-fig, ax_val = plt.subplots(figsize=(13,8))
-ax_price    = ax_val.twinx()
-
-ax_val.plot(df.index, df["valor_musd"],     label="Valor exportado (M USD)",
-              color=colors["valor_musd"])
-ax_price.plot(df.index, df["precio_usd_MPC"], label="Precio (USD / MPC)",
-              color=colors["precio_usd_MPC"])
-
-# ── 7. Helpers de graficos_utils ─────────────────────────────────────
-add_hitos(ax_val, df.index, hitos_v, hitos_offset, line_kwargs={"linewidth":0.9})
-
-medias_offset = {
-    "Expansión 86-99": (1988, .90),
-    "Crisis 00-05": (2000, .90),
-    "Expansión 06-13": (2006, .90),
-    "Recesión 14-24":  (2016, .90),
-}
-y_max = df["valor_musd"].max()
-add_cycle_means_multi(ax_val, cycle_stats, medias_offset,
-                      abbr, colors, line_spacing=y_max*0.03)
-
-# ── 7.3 Valores puntuales ────────────────────────────────────────────
-# • Anotamos sólo 'valor_musd' en ax_val
-add_year_value_annotations(
-    ax_val, df, anot_years,
-    ["valor_musd"],          # sólo valor
-    {"valor_musd": annotation_offsets["valor_musd"]},
-    {"valor_musd": colors["valor_musd"]},
-    arrow_lw=0.5
-)
-
-# • Anotamos sólo 'precio_usd_MPC' en ax_price
-add_year_value_annotations(
-    ax_price, df, anot_years,
-    ["precio_usd_MPC"],      # sólo precio
-    {"precio_usd_MPC": annotation_offsets["precio_usd_MPC"]},
-    {"precio_usd_MPC": colors["precio_usd_MPC"]},
-    arrow_lw=0.5
-)
-
-
-add_period_growth_annotations_multi(
-    ax_val, df, growth_periods,
-    cols, period_growth_offsets,
-    colors, abbr
-)
-
-# ── 8. Etiquetas y leyenda limpia ────────────────────────────────────
-ax_val.set_title(f"Gas Natural: Valor vs. Precio ({df.index[0]}–{df.index[-1]})",
-                 fontweight="bold")
-ax_val.set_xlabel("Año")
-ax_val.set_ylabel("Valor exportado (millones USD)", color=colors["valor_musd"])
-ax_price.set_ylabel("Precio (USD por MPC)",          color=colors["precio_usd_MPC"])
-
-ax_val.tick_params(axis="y", labelcolor=colors["valor_musd"])
-ax_price.tick_params(axis="y", labelcolor=colors["precio_usd_MPC"])
-ax_val.set_xticks(df.index[::max(1,len(df)//31)])
-ax_val.tick_params(axis="x", rotation=45)
-
-# ----- leyenda filtrada (sin _childX) -------------------------------
-handles, labels = ax_val.get_legend_handles_labels()
-handles2, labels2 = ax_price.get_legend_handles_labels()
-handles += handles2
-labels  += labels2
-filtered = [(h,l) for h,l in zip(handles,labels) if not l.startswith('_')]
-if filtered:
-    h_f, l_f = zip(*filtered)
-    ax_val.legend(h_f, l_f, loc="upper left", fontsize=11)
-
-plt.tight_layout()
-plt.savefig(os.path.join(OUTPUT_DIR,"gas_natural_valor_precio_dual_axis.png"),
-            dpi=300)
-plt.show()
-
-
-# %%
-# ── 1. Nueva carga de datos (solo volumen) ───────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df_vol = (
-        pd.read_sql(
-            "SELECT año, volumen_MMMc FROM exportacion_gas_natural",
-            conn,
-            index_col="año"
-        )
-        .sort_index()
-    )
-
-# ── 2. Definición de ciclos y estadísticas ───────────────────────────
-period_slices = {
-    "Expansión 86-99": slice(1986, 1999),
-    "Crisis 00-05":    slice(2000, 2005),
-    "Expansión 06-13": slice(2006, 2013),
-    "Recesión 14-24":  slice(2014, 2024),
-}
-cycle_stats_vol = {
-    name: df_vol.loc[slice_].mean().to_dict()
-    for name, slice_ in period_slices.items()
-}
-
-# ── 3. Hitos, años clave y offsets ────────────────────────────────────
-hitos_offset = {yr: 0.88 for yr in hitos_v}   # texto al 88% del eje y
-
-anot_years = [1987, 2000, 2006, 2014, 2023]
-annotation_offsets_vol = {
-    "volumen_MMMc": {
-        1987: (0, 500),
-        2000: (0.3, -1100),
-        2006: (0.3, -1100),
-        2014: (0, 350),
-        2023: (0, 500),
-    }
-}
-
-# ── 4. Periodos de crecimiento y offsets ─────────────────────────────
-growth_periods = [(1987, 2000), (2000, 2006), (2006, 2014), (2014, 2023)]
-period_growth_offsets = {
-    "1987-2000": (1995, 0.75),
-    "2000-2006": (2001, 0.75),
-    "2006-2014": (2006.2, 0.75),
-    "2014-2023": (2016, 0.35),
-}
-
-# ── 5. Offset para medias de ciclo ───────────────────────────────────
-cycle_text_offsets = {
-    "Expansión 86-99": (1995, 0.95),
-    "Crisis 00-05":    (2001, 0.95),
-    "Expansión 06-13": (2006.2, 0.95),
-    "Recesión 14-24":  (2016, 0.95),
-}
-
-# ── 6. Paleta y abreviatura ──────────────────────────────────────────
-colors_vol = {"volumen_MMMc": "tab:blue"}
-abbr_vol   = {"volumen_MMMc": "Vol"}
-
-# ── 7. Gráfico de volumen ────────────────────────────────────────────
-fig_v, ax_v = plt.subplots(figsize=(13, 8))
-
-# Serie
-ax_v.plot(
-    df_vol.index,
-    df_vol["volumen_MMMc"],
-    label="Volumen (MMmc)",
-    color=colors_vol["volumen_MMMc"]
-)
-
-# Hitos
-add_hitos(
-    ax_v,
-    df_vol.index,
-    hitos_v,
-    hitos_offset,
-    line_kwargs={"lw": 1.2}
-)
-
-# Medias de ciclo
-add_cycle_means_multi(
-    ax_v,
-    cycle_stats_vol,
-    cycle_text_offsets,
-    abbr_vol,
-    colors_vol,
-    line_spacing=df_vol["volumen_MMMc"].max() * 0.03
-)
-
-# Anotaciones de valores puntuales
-add_year_value_annotations(
-    ax_v,
-    df_vol,
-    anot_years,
-    ["volumen_MMMc"],
-    annotation_offsets_vol,
-    colors_vol,
-    arrow_lw=1.0
-)
-
-# Tasas de crecimiento
-add_period_growth_annotations_multi(
-    ax_v,
-    df_vol,
-    growth_periods,
-    ["volumen_MMMc"],
-    period_growth_offsets,
-    colors_vol,
-    abbr_vol
-)
-
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax_v.set_title(
-    f"Evolución del Volumen de Gas Natural (MMmc) "
-    f"({df_vol.index[0]}–{df_vol.index[-1]})",
-    fontweight="bold"
-)
-ax_v.set_xlabel("Año")
-ax_v.set_ylabel("Volumen (MMmc)")
-ax_v.set_xticks(df_vol.index[::max(1, len(df_vol)//31)])
-ax_v.tick_params(axis="x", rotation=45)
-ax_v.legend(loc="upper left", fontsize=10)
-
-plt.tight_layout()
-plt.savefig(
-    os.path.join(OUTPUT_DIR, "gas_natural_volumen_MMMc.png"),
-    dpi=300
-)
-plt.show()
-
-
-# %%
-df
diff --git a/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones.py b/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones.py
deleted file mode 100644
index f7de611..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones.py
+++ /dev/null
@@ -1,119 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-
-# ── 1. Parámetros y rutas ─────────────────────────────────────────────────────
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-# ── 2. Slices de ciclo (periodos macro) ───────────────────────────────────────
-CYCLES = {
-    "Crisis 82-85":       slice(1982, 1985),
-    "Expansión 86-99":    slice(1986, 1999),
-    "Crisis 00-05":       slice(2000, 2005),
-    "Acumulación 06-13":  slice(2006, 2013),
-    "Recesión 14-23":     slice(2014, 2024),   # ajusta a 2024+ si añades más datos
-}
-
-# ── 3. Hitos visuales (líneas verticales) ─────────────────────────────────────
-hitos_v = {
-    1981: "Crisis", 1985: "Expansión", 1999: "Crisis",
-    2005: "Expansión", 2014: "Recesión"
-}
-hitos_offset = {
-    1981: (0, 0.10),
-    1985: (1.9, 0.05),
-    1999: (0, 0.10),
-    2005: (1.9, 0.05),
-    2014: (1.9, 0.05)
-}
-# ── 4. Cargar datos completos ────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query(
-        "SELECT * FROM exportaciones_tradicionales_no_tradicionales", conn
-    ).set_index("año")
-
-# NO recortar la serie -> se grafica todo el rango disponible
-df["total"] = df["tradicionales"] + df["no_tradicionales"]
-pct = df[["tradicionales", "no_tradicionales"]].div(df["total"], axis=0) * 100
-
-# ── 5. Estadísticas promedio por ciclo ────────────────────────────────────────
-cycle_stats = {
-    name: pct.loc[slice_].mean() for name, slice_ in CYCLES.items()
-}
-
-# ── 6. Gráfico stacked bar ────────────────────────────────────────────────────
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-fig, ax = plt.subplots(figsize=(15, 7))
-pct.plot(kind="bar", stacked=True, ax=ax, width=0.8)
-
-ax.set_ylabel("Participación (%)")
-ax.set_xlabel("Año")
-ax.set_title("Participación de Exportaciones Tradicionales vs No Tradicionales (1952-2023)",
-             fontweight="bold")
-ax.legend(["Tradicionales", "No tradicionales"], loc="upper left",
-          bbox_to_anchor=(1, 1))
-plt.xticks(rotation=45)
-
-# ── 7. Insertar hitos visuales ────────────────────────────────────────────────
-fig.subplots_adjust(right=0.74)  # deja margen a la derecha para estadísticas
-for yr, lbl in hitos_v.items():
-    if yr in pct.index:
-        idx = pct.index.get_loc(yr)
-        y_max=ax.get_ylim()[1]
-        ax.axvline(
-            x=idx + 0.5, color="gray", ls="--", lw=1.5, zorder=5
-        )
-        dx,dy=hitos_offset.get(yr,(0,0.5))
-        ax.text(
-            idx + 0.5+dx,dy, lbl, rotation=0 if lbl=='Expansión' or lbl=='Recesión' else 90, ha="center", va="top",
-            fontsize=12, color="black",
-            transform=ax.get_xaxis_transform(), clip_on=False,
-            bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
-            zorder=6
-        )
-
-# ── 8. Cuadros con promedios por ciclo ────────────────────────────────────────
-y0 = 0.80            # posición inicial en el eje Y (transAxes)
-dy = 0.11            # espacio vertical entre cuadros
-for i, (name, stats) in enumerate(cycle_stats.items()):
-    text = (
-        f"{name}\n"
-        f"Tradicionales:  {stats['tradicionales']:.1f}%\n"
-        f"No tradic.:    {stats['no_tradicionales']:.1f}%"
-    )
-    ax.text(1.02, y0 - i*dy, text,
-            transform=ax.transAxes, fontsize=10, va="center", ha="left",
-            bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-
-# ── 9. Guardar y mostrar ──────────────────────────────────────────────────────
-plt.tight_layout()
-plt.savefig(os.path.join(OUTPUT_DIR, "participacion_exportaciones.png"),
-            dpi=300)
-plt.show()
-
-# ── 10. Verificación ──────────────────────────────────────────────────────────
-assert abs(pct.sum(axis=1) - 100).max() < 1e-6, "Las participaciones no suman 100%"
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones_tradicionales.py b/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones_tradicionales.py
deleted file mode 100644
index 22ef03c..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/participacion_exportaciones_tradicionales.py
+++ /dev/null
@@ -1,143 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-
-# ── 1. Parámetros y rutas ─────────────────────────────────────────────────────
-PRE_CRISIS_YEARS=slice(1992, 1999)  
-CRISIS_YEARS = slice(2000, 2005)            # 2002-2005 inclusive
-POST_YEARS   = slice(2006, 2014)            # 2006-2023 inclusive
-RECESION_YEARS =slice(2014, 2024) 
-OUTPUT_DIR   = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-# ── 2. Estilo profesional ─────────────────────────────────────────────────────
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-# ── 3. Carga de datos ─────────────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query("SELECT * FROM exportaciones_tradicionales", conn)
-
-df.set_index("año", inplace=True)            # ajusta si tu tabla llega a 2024+
-
-# ── 4. Cálculo de participaciones (%) ─────────────────────────────────────────
-df["total"] = df["minerales"] + df["hidrocarburos"]
-pct = df[["minerales", "hidrocarburos"]].div(df["total"], axis=0) * 100
-
-# ── 5. Estadísticas promedio por periodo ──────────────────────────────────────
-avg_pre_crisis=pct.loc[PRE_CRISIS_YEARS].mean()
-avg_crisis = pct.loc[CRISIS_YEARS].mean()
-avg_post   = pct.loc[POST_YEARS].mean()
-avg_recesion=pct.loc[RECESION_YEARS].mean()
-
-# ── 6. Gráfico stacked-bar ────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15, 7))
-pct.plot(kind="bar", stacked=True, ax=ax, width=0.8)
-
-ax.set_ylabel("Participación (%)")
-ax.set_xlabel("Año")
-ax.set_title(
-    "Participación de Minerales y Hidrocarburos en Exportaciones Tradicionales (2002-2023)",
-    fontweight="bold"
-)
-ax.legend(["Minerales", "Hidrocarburos"], loc="upper left",
-          bbox_to_anchor=(1, 1))
-plt.xticks(rotation=45)
-
-# ── 6.5. Líneas verticales y texto de hitos (posición basada en índice) ────
-hitos_offset = {
-    1999: (0, 0.10),
-    2005: (1.5, 0.05),
-    2014: (1.5, 0.05)
-}
-
-# asegúrate de ajustar márgenes antes de tight_layout
-fig.subplots_adjust(right=0.8)
-
-# ── 5.1 Hitos visuales ─────────────────────────────────────────────────────
-hitos_v = {
-    1999: "Crisis",
-    2005: "Expansión",
-    2014: "Recesión"
-}
-fig.subplots_adjust(right=0.72)
-
-for yr, lbl in hitos_v.items():
-    if yr in pct.index:
-        idx = pct.index.get_loc(yr)
-        y_max=ax.get_ylim()[1]
-        ax.axvline(
-            x=idx + 0.5, color="gray", ls="--", lw=1.5, zorder=5
-        )
-        dx,dy=hitos_offset.get(yr,(0,0.5))
-        ax.text(
-            idx + 0.5+dx,dy, lbl, rotation=0 if lbl=='Expansión' or lbl=='Recesión' else 90, ha="center", va="top",
-            fontsize=12, color="black",
-            transform=ax.get_xaxis_transform(), clip_on=False,
-            bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
-            zorder=6
-        )
-
-
-
-# ── 7. Cajas de resumen ───────────────────────────────────────────────────────
-stats_pre_crisis = (
-    f"Minerales:     {avg_pre_crisis['minerales']:.1f}%\n"
-    f"Hidrocarburos: {avg_pre_crisis['hidrocarburos']:.1f}%"
-)
-stats_crisis = (
-    f"Minerales:     {avg_crisis['minerales']:.1f}%\n"
-    f"Hidrocarburos: {avg_crisis['hidrocarburos']:.1f}%"
-)
-stats_post = (
-    f"Minerales:     {avg_post['minerales']:.1f}%\n"
-    f"Hidrocarburos: {avg_post['hidrocarburos']:.1f}%" 
-)
-stats_recesion=(
-    f"Minerales:     {avg_recesion['minerales']:.1f}%\n"
-    f"Hidrocarburos: {avg_recesion['hidrocarburos']:.1f}%"
-)
-
-#ax text para las estadisticas pre_crisis
-ax.text(1.02, 0.80, "Expansión (1992-1999)\n" + stats_pre_crisis,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-ax.text(1.02, 0.60, "Crisis (2000-2005)\n" + stats_crisis,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-ax.text(1.02, 0.40, "Expansión (2006-2013)\n" + stats_post,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-#recesion
-ax.text(1.02, 0.20, "Recesión (2014-2024)\n" + stats_recesion,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-
-# ── 8. Guardar y mostrar ──────────────────────────────────────────────────────
-plt.tight_layout()
-plt.savefig(os.path.join(OUTPUT_DIR, "participacion_minerales_hidrocarburo.png"),
-            dpi=300)
-plt.show()
-
-# ── 9. Verificación rápida ────────────────────────────────────────────────────
-assert abs(pct.sum(axis=1) - 100).max() < 1e-6, "Las participaciones no suman 100%"
diff --git a/notebooks/tesis/serie_completa/exportaciones/participacion_gas_natural_y_otros_hidrocarburos.py b/notebooks/tesis/serie_completa/exportaciones/participacion_gas_natural_y_otros_hidrocarburos.py
deleted file mode 100644
index 1113d7e..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/participacion_gas_natural_y_otros_hidrocarburos.py
+++ /dev/null
@@ -1,147 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-
-# ── 1. Parámetros y rutas ─────────────────────────────────────────────────────
-CRISIS_YEARS_NEOLIBERALISMO=slice(1982, 1986)
-EXPANSION=slice(1986,2002)
-CRISIS_YEARS     = slice(2002, 2006)   # 2002-2005
-POST_YEARS       = slice(2006, 2014)   # 2006-2013
-RECESION_YEARS   = slice(2014, 2024)   # 2014-2023
-
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/exportaciones"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-# ── 2. Estilo profesional ─────────────────────────────────────────────────────
-plt.style.use("seaborn-v0_8-whitegrid")
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-# ── 3. Carga de datos ─────────────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query(
-        "SELECT * FROM participacion_gas_hidrocarburos_total_exportaciones_hidrocarburos",
-        conn
-    )
-
-df.set_index("año", inplace=True)           # índice = año
-
-# ── 4. Participaciones (%) ────────────────────────────────────────────────────
-pct = df[["exportacion_gas", "otros_hidrocarburos"]]  # ya están en %
-hitos_offset = {
-    1981: (0, 0.10),
-    1985: (1.9, 0.05),
-    1999: (0, 0.10),
-    2005: (1.9, 0.05),
-    2014: (1.9, 0.05)
-}
-# ── 5. Estadísticas promedio por periodo ──────────────────────────────────────
-avg_crisis_neoliberalismo=pct.loc[CRISIS_YEARS_NEOLIBERALISMO].mean()
-avg_expansion = pct.loc[EXPANSION].mean()
-avg_crisis     = pct.loc[CRISIS_YEARS].mean()
-avg_post       = pct.loc[POST_YEARS].mean()
-avg_recesion   = pct.loc[RECESION_YEARS].mean()
-
-# ── 6. Gráfico stacked-bar ────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15, 7))
-pct.plot(kind="bar", stacked=True, ax=ax, width=0.8)
-
-ax.set_ylabel("Participación (%)")
-ax.set_xlabel("Año")
-ax.set_title(
-    "Participación del Gas Natural y Otros Hidrocarburos \n"
-    "en el Total de Exportaciones de Hidrocarburos (1980-2023)",
-    fontweight="bold"
-)
-ax.legend(["Gas natural", "Otros hidrocarburos"], loc="upper left",
-          bbox_to_anchor=(1, 1))
-plt.xticks(rotation=45)
-
-# ── 6.5. Líneas verticales y texto de hitos (posición basada en índice) ─────
-hitos_v = {1981: "Crisis", 1985: "Expansión", 1999: "Crisis", 2005: "Expansión", 2014: "Recesión"}
-
-fig.subplots_adjust(right=0.8)              # deja espacio para las cajas
-
-for yr, lbl in hitos_v.items():
-    if yr in pct.index:
-        idx = pct.index.get_loc(yr)
-        y_max=ax.get_ylim()[1]
-        ax.axvline(
-            x=idx + 0.5, color="gray", ls="--", lw=1.5, zorder=5
-        )
-        dx,dy=hitos_offset.get(yr,(0,0.5))
-        ax.text(
-            idx + 0.5+dx,dy, lbl, rotation=0 if lbl=='Expansión' or lbl=='Recesión' else 90, ha="center", va="top",
-            fontsize=12, color="black",
-            transform=ax.get_xaxis_transform(), clip_on=False,
-            bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
-            zorder=6
-        )
-
-# ── 7. Cajas de resumen ───────────────────────────────────────────────────────
-stats_crisis_neoliberalismo=(
-    f"Gas:  {avg_crisis_neoliberalismo.exportacion_gas:.1f}%\n"
-    f"Otros:{avg_crisis_neoliberalismo.otros_hidrocarburos:.1f}%"
-)
-stats_expansion = (
-    f"Gas:  {avg_expansion.exportacion_gas:.1f}%\n"
-    f"Otros:{avg_expansion.otros_hidrocarburos:.1f}%"
-)
-stats_crisis = (
-    f"Gas:  {avg_crisis.exportacion_gas:.1f}%\n"
-    f"Otros:{avg_crisis.otros_hidrocarburos:.1f}%"
-)
-stats_post = (
-    f"Gas:  {avg_post.exportacion_gas:.1f}%\n"
-    f"Otros:{avg_post.otros_hidrocarburos:.1f}%"
-)
-stats_recesion = (
-    f"Gas:  {avg_recesion.exportacion_gas:.1f}%\n"
-    f"Otros:{avg_recesion.otros_hidrocarburos:.1f}%"
-)
-ax.text(1.02, 0.80, "Crisis (1982-1985)\n" + stats_crisis_neoliberalismo,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-
-ax.text(1.02, 0.65, "Expansion (1986-2001)\n" + stats_expansion,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-ax.text(1.02, 0.50, "Crisis (2002-2005)\n" + stats_crisis,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-ax.text(1.02, 0.35, "Acumulacion (2006-2013)\n" + stats_post,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-ax.text(1.02, 0.20, "Recesión (2014-2023)\n" + stats_recesion,
-        transform=ax.transAxes, fontsize=10, va="center", ha="left",
-        bbox=dict(facecolor="white", alpha=0.8, edgecolor="black"))
-
-# ── 8. Guardar y mostrar ──────────────────────────────────────────────────────
-plt.tight_layout()
-plt.savefig(os.path.join(OUTPUT_DIR, "participacion_gas_total_hidrocarburos.png"),
-            dpi=300) 
-plt.show()
-
-# ── 9. Verificación rápida ────────────────────────────────────────────────────
-assert abs(pct.sum(axis=1) - 100).max() < 1e-6, "Las participaciones no suman 100 %"
-
-
diff --git a/notebooks/tesis/serie_completa/exportaciones/prueba.py b/notebooks/tesis/serie_completa/exportaciones/prueba.py
deleted file mode 100644
index 8a98da6..0000000
--- a/notebooks/tesis/serie_completa/exportaciones/prueba.py
+++ /dev/null
@@ -1,110 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: env
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import numpy as np
-
-# Definir la función según lo especificado
-def add_participation_cycle_boxes(
-    ax,
-    df: pd.DataFrame,
-    periods: dict[str, slice],
-    components: list[str],
-    total_col: str,
-    offsets: dict[str, tuple[float, float]],
-    abbr_map: dict[str, str] | None = None,
-    colors: dict[str, str] | None = None,
-    *,
-    header_kwargs: dict | None = None,
-    text_kwargs: dict | None = None,
-    line_spacing_ratio: float = 0.05,
-):
-    abbr_map     = abbr_map or {c: c for c in components}
-    colors       = colors   or {c: ax.get_lines()[0].get_color() for c in components}
-    header_kwargs= header_kwargs or {
-        'ha':'left','va':'top','fontsize':12,'fontweight':'bold','color':'black','zorder':7
-    }
-    text_kwargs  = text_kwargs   or {
-        'ha':'left','va':'top','fontsize':11,'zorder':7
-    }
-
-    y_max        = ax.get_ylim()[1]
-    line_spacing = y_max * line_spacing_ratio
-
-    for ciclo, period in periods.items():
-        df_period = df.loc[period, components + [total_col]].dropna()
-        pct = df_period[components].div(df_period[total_col], axis=0) * 100
-        medias_pct = pct.mean()
-
-        x0, y_frac = offsets.get(ciclo, (df.index[0], 0.8))
-        y0 = y_max * y_frac
-
-        ax.text(x0, y0, ciclo, **header_kwargs)
-        for i, comp in enumerate(components):
-            pct_med = medias_pct[comp]
-            y = y0 - (i+1)*line_spacing
-            txt = fr"$\%_{{{abbr_map.get(comp,comp)}}}$: {pct_med:.1f}\%"
-            kw = text_kwargs.copy()
-            kw['color'] = colors.get(comp, kw.get('color'))
-            ax.text(x0, y, txt, **kw)
-
-# Crear DataFrame de ejemplo para años 1986-2024
-years = list(range(1986, 2025))
-np.random.seed(0)
-minerales = np.random.uniform(100, 200, len(years))
-hidrocarburos = np.random.uniform(80, 160, len(years))
-df = pd.DataFrame({
-    'año': years,
-    'minerales': minerales,
-    'hidrocarburos': hidrocarburos,
-})
-df.set_index('año', inplace=True)
-df['total'] = df['minerales'] + df['hidrocarburos']
-
-# Definir periodos y offsets
-periods = {
-    "Expansión 86-99": slice(1986, 1999),
-    "Expansión 06-13": slice(2006, 2013),
-    "Recesión 14-24":  slice(2014, 2024),
-}
-offsets = {
-    "Expansión 86-99": (1992, 0.9),
-    "Expansión 06-13": (2009, 0.9),
-    "Recesión 14-24":  (2019, 0.9),
-}
-abbr_map = {'minerales':'Min','hidrocarburos':'Hc'}
-colors = {'minerales':'#1f77b4','hidrocarburos':'#ff7f0e'}
-
-# Graficar y aplicar la función
-fig, ax = plt.subplots(figsize=(10, 6))
-ax.plot(df.index, df['minerales'], label='Minerales', color=colors['minerales'])
-ax.plot(df.index, df['hidrocarburos'], label='Hidrocarburos', color=colors['hidrocarburos'])
-ax.legend()
-
-add_participation_cycle_boxes(
-    ax, df, periods,
-    components=['minerales','hidrocarburos'],
-    total_col='total',
-    offsets=offsets,
-    abbr_map=abbr_map,
-    colors=colors
-)
-
-ax.set_title("Demo: Participación media por ciclo")
-ax.set_xlabel("Año")
-ax.set_ylabel("Valor")
-plt.show()
-
diff --git a/notebooks/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py b/notebooks/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py
deleted file mode 100644
index e9a5101..0000000
--- a/notebooks/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py
+++ /dev/null
@@ -1,314 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-import numpy as np
-# ── 1. Parámetros y rutas ────────────────────────────────────────────────────
-CRISIS_52_55     = slice(1952, 1955)   # Crisis
-EXPANSION_56_69  = slice(1956, 1969)   # Expansión
-RECESION_70_81   = slice(1970, 1981)   # Recesión
-CRISIS_82_85     = slice(1982, 1985)   # Crisis (neoliberal)
-EXPANSION_86_99  = slice(1986, 1999)   # Expansión
-CRISIS_00_05     = slice(2000, 2005)   # Crisis
-ACUMULACION_06_13= slice(2006, 2013)   # Expansión (acumulación)
-RECESION_14_23   = slice(2014, 2024)   # Recesión
-
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/pib"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-# ── 2. Carga de datos ────────────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query("SELECT * FROM participacion_pib_ramas", conn)
-
-df.set_index("año", inplace=True)
-
-# Columnas a graficar (excluimos minas_canteras_total)
-cols = [
-    "agropecuario",
-    "mineria",
-    "petroleo_crudo_y_gas_natural",
-    "industria_manufacturera",
-    "construcciones",
-    "energia",
-    "transportes",
-    "comercio_finanzas",
-    "gobierno_general",
-    "propiedad_vivienda",
-    "servicios"
-]
-pct = df[cols]
-
-# ── 3. Estadísticas promedio por periodo ─────────────────────────────────────
-avg_crisis_52_55      = pct.loc[CRISIS_52_55].mean()
-avg_expansion_56_69   = pct.loc[EXPANSION_56_69].mean()
-avg_recesion_70_81    = pct.loc[RECESION_70_81].mean()
-avg_crisis_82_85      = pct.loc[CRISIS_82_85].mean()
-avg_expansion_86_99   = pct.loc[EXPANSION_86_99].mean()
-avg_crisis_00_05      = pct.loc[CRISIS_00_05].mean()
-avg_acumulacion_06_13 = pct.loc[ACUMULACION_06_13].mean()
-avg_recesion_14_23    = pct.loc[RECESION_14_23].mean()
-#offset
-hitos_offset = {
-    1951: (1, 0.10),
-    1955: (3, 0.05),
-    1969: (3, 0.05),
-    1981: (1, 0.10),
-    1985: (3, 0.05),
-    1999: (1, 0.10),
-    2005: (3, 0.05),
-    2014: (3, 0.05)
-}
-
-# ── 4. Gráfico stacked-bar ──────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(14, 7))
-pct.plot(kind="bar", stacked=True, ax=ax, width=0.8)
-
-ax.set_ylabel("Participación (%)")
-ax.set_xlabel("Año")
-ax.set_title("Participación sectorial del PIB 1950-2023",
-             fontweight="bold")
-
-# muevo la leyenda fuera del área de gráfico, abajo
-ax.legend(
-    loc="upper center",
-    bbox_to_anchor=(0.5, -0.15),
-    ncol=6,            # ajusta según cuántos ítems tengas
-    fontsize=10,
-    frameon=False
-)
-fig.subplots_adjust(bottom=0.25)   # expande margen inferior
-
-# construyo un array 0,1,2,… tan largo como df.index
-positions = np.arange(len(df.index))
-# uso solo cada segunda posición, y como etiqueta el año correspondiente
-plt.xticks(positions[::2], df.index[::2], rotation=45)
-
-# ── 4.5 Líneas verticales y texto de hitos ──────────────────────────────────
-hitos_v = {
-    1951: "Crisis",
-    1955: "Expansión",
-    1969: "Recesión",
-    1981: "Crisis",
-    1985: "Expansión",
-    1999: "Crisis",
-    2005: "Expansión",
-    2014: "Recesión"
-}
-fig.subplots_adjust(right=0.72)
-
-for yr, lbl in hitos_v.items():
-    if yr in pct.index:
-        idx = pct.index.get_loc(yr)
-        y_max=ax.get_ylim()[1]
-        ax.axvline(
-            x=idx + 0.5, color="gray", ls="--", lw=1.5, zorder=5
-        )
-        dx,dy=hitos_offset.get(yr,(0,0.5))
-        ax.text(
-            idx + 0.5+dx,dy, lbl, rotation=0 if lbl=='Expansión' or lbl=='Recesión' else 90, ha="center", va="top",
-            fontsize=12, color="black",
-            transform=ax.get_xaxis_transform(), clip_on=False,
-            bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
-            zorder=6
-        )
-MEAN_OFFSETS = {
-    CRISIS_52_55:      {'consumo_publico': (0.0, 12.0)},
-    EXPANSION_56_69:   {'consumo_publico': (0.0, 14.5)},
-    RECESION_70_81:    {'consumo_publico': (0.0, 14.5)},
-    CRISIS_82_85:      {'consumo_publico': (0.0, 12.0)},
-    EXPANSION_86_99:   {'consumo_publico': (0.0, 15.0)},
-    CRISIS_00_05:      {'consumo_publico': (0.0, 12.0)},
-    ACUMULACION_06_13: {'consumo_publico': (0.0, 12.0)},
-    RECESION_14_23:    {'consumo_publico': (0.0, 12.0)},
-}
-
-
-# 2️⃣  Componentes cuyos promedios NO quieres anotar
-SKIP_MEANS = {
-    CRISIS_52_55:      {'energia'},
-    EXPANSION_56_69:   {'energia'},
-    RECESION_70_81:    {'energia'},
-    CRISIS_82_85:      {'energia'},
-    EXPANSION_86_99:   {'energia'},
-    CRISIS_00_05:      {'energia'},
-    ACUMULACION_06_13: {'energia'},
-    RECESION_14_23:    {'energia'},
-}
-
-def annotate_cycle_means(
-    ax, data, cycle_slice, cols,
-    offsets=None, skip=None,
-    fmt="{val:.0f}", **text_kw
-):
-    sub = data.loc[cycle_slice, cols]
-    if sub.empty:
-        return
-
-    means = sub.mean()
-    start_idx = data.index.get_loc(sub.index[0])
-    end_idx   = data.index.get_loc(sub.index[-1])
-    x_mid     = (start_idx + end_idx) / 2
-
-    cum = 0
-    for col in cols:
-        # omitir si el usuario lo indica
-        if skip and col in skip.get(cycle_slice, set()):
-            cum += means[col]
-            continue
-
-        val = means[col]
-        dx, dy = (0, 0)
-        if offsets:
-            dx, dy = offsets.get(cycle_slice, {}).get(col, (0, 0))
-
-        ax.text(
-            x_mid + dx,
-            cum + val/2 + dy,
-            fmt.format(val=val),
-            ha="center", va="center",
-            zorder=6,
-            **text_kw
-        )
-        cum += val
-# ── 5.2 Medias por ciclo ─────────────────────────────────────────────
-# ── 5.2 Medias por ciclo (con offsets y skips) ────────────────────────────
-cycles = [
-    CRISIS_52_55, EXPANSION_56_69, RECESION_70_81, CRISIS_82_85,
-    EXPANSION_86_99, CRISIS_00_05, ACUMULACION_06_13, RECESION_14_23,
-]
-for ciclo in cycles:
-    annotate_cycle_means(
-        ax, pct, ciclo, cols,
-        offsets=MEAN_OFFSETS,
-        skip=SKIP_MEANS,
-        fontsize=13, color="black", fontweight="bold"
-    )
-
-
-# ── 6. Guardar y mostrar ────────────────────────────────────────────────────
-plt.tight_layout()
-out_path = os.path.join(OUTPUT_DIR, "participacion_pib_ramas.png")
-plt.savefig(out_path, dpi=300)
-plt.show()
-
-out_path
-
-
-# %%
-import seaborn as sns
-df_means = pd.DataFrame({
-    #"Crisis 52–55":      avg_crisis_52_55,
-    "Expansión 56–68":   avg_expansion_56_69,
-    "Recesión 70–81":    avg_recesion_70_81,
-    #"Crisis 82–85":      avg_crisis_82_85,
-    "Expansión 86–99":   avg_expansion_86_99,
-    #"Crisis 00–05":      avg_crisis_00_05,
-    "Acumulación 06–13": avg_acumulacion_06_13,
-    "Recesión 14–23":    avg_recesion_14_23
-}).round(1)
-
-# ── 5. Gráfico seaborn (tabla en grises sobrio) ───────────────────────────────
-fig, ax = plt.subplots(figsize=(12, 6))
-sns.heatmap(
-    df_means,
-    annot=True, fmt=".1f",
-    cmap="Blues",
-    cbar=False,
-    linewidths=0.5,
-    linecolor="lightgray",
-    ax=ax
-)
-
-ax.set_title(
-    "Promedios de participación sectorial del PIB\npor ciclo económico (1952–2023)",
-    fontweight='bold', pad=20
-)
-ax.set_ylabel("Rama de actividad")
-ax.set_xlabel("Periodo económico")
-ax.set_yticklabels(ax.get_yticklabels(), rotation=0)
-ax.set_xticklabels(ax.get_xticklabels(), rotation=45, ha='right')
-
-plt.tight_layout()
-out_file = os.path.join(OUTPUT_DIR, "tabla_promedios_ciclos_seaborn.png")
-fig.savefig(out_file)
-plt.show()
-
-# %%
-import pandas as pd
-import seaborn as sns
-import matplotlib.pyplot as plt
-import sqlite3
-import os
-
-# ── Parámetros ────────────────────────────────────────────────────────────────
-OUTPUT_DIR = "./figuras"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-YEARS = slice(2016, 2024)  # 2018–2023 inclusive
-
-# ── Estilo ────────────────────────────────────────────────────────────────────
-plt.rcParams.update({
-    "font.family": "serif",
-    "font.size": 12,
-    "axes.titlesize": 14,
-    "axes.labelsize": 12,
-    "grid.linestyle": "--",
-    "lines.linewidth": 2,
-    "figure.dpi": 150,
-    "savefig.bbox": "tight"
-})
-
-# ── Carga y filtrado ──────────────────────────────────────────────────────────
-with sqlite3.connect("../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query("SELECT * FROM participacion_pib_ramas", conn, index_col="año")
-
-# Seleccionar años 2018–2023
-df_subset = df.loc[YEARS]
-
-# ── Gráfica con seaborn ───────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(10, 4))
-sns.heatmap(
-    df_subset,
-    annot=True,
-    fmt=".1f",
-    cmap="Blues",
-    cbar=False,
-    linewidths=0.5,
-    linecolor="lightgray",
-    ax=ax
-)
-
-ax.set_title("Participación sectorial del PIB (2018–2023)", fontweight="bold", pad=12)
-ax.set_ylabel("Año")
-ax.set_xlabel("Rama de actividad")
-ax.set_yticklabels(ax.get_yticklabels(), rotation=0)
-ax.set_xticklabels(ax.get_xticklabels(), rotation=45, ha='right')
-
-# ── Guardar imagen ───────────────────────────────────────────────────────────
-
-plt.show()
-
-
-
-# %%
-df
diff --git a/notebooks/tesis/serie_completa/pib/participacion_pib_tipo_de_gasto.py b/notebooks/tesis/serie_completa/pib/participacion_pib_tipo_de_gasto.py
deleted file mode 100644
index 70d74e5..0000000
--- a/notebooks/tesis/serie_completa/pib/participacion_pib_tipo_de_gasto.py
+++ /dev/null
@@ -1,325 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-import numpy as np
-
-# ── 1. Parámetros y rutas ────────────────────────────────────────────────────
-CRISIS_52_55      = slice(1952, 1955)   # Crisis
-EXPANSION_56_69   = slice(1956, 1969)   # Expansión
-RECESION_70_81    = slice(1970, 1981)   # Recesión
-CRISIS_82_85      = slice(1982, 1985)   # Crisis (neoliberal)
-EXPANSION_86_99   = slice(1986, 1999)   # Expansión
-CRISIS_00_05      = slice(2000, 2005)   # Crisis
-ACUMULACION_06_13 = slice(2006, 2013)   # Acumulación (expansión)
-RECESION_14_23    = slice(2014, 2024)   # Recesión
-
-OUTPUT_DIR = "../../../../assets/tesis/serie_completa/pib"
-os.makedirs(OUTPUT_DIR, exist_ok=True)
-
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-# ── 2. Carga de datos ───────────────────────────────────────────────────────
-with sqlite3.connect("../../../../db/proyectomacro.db") as conn:
-    df = pd.read_sql_query("SELECT * FROM PIB_Real_Gasto", conn)
-
-df.set_index("año", inplace=True)
-
-# ── 3. Selección de componentes y cálculo de participaciones (%) ───────────
-componentes = [
-    'gastos_consumo',
-    'formacion_capital',
-    'exportacion_bienes_servicios',
-    'importacion_bienes',
-    'consumo_privado',
-    'consumo_publico'
-]
-#offset
-# Extraer sólo esas columnas
-comp = df[componentes]
-
-# Convertir a porcentaje del PIB real base 1990
-pct = comp.div(df["pib_real_base_1990"], axis=0).multiply(100)
-
-# ── 4. Estadísticas promedio por ciclo ──────────────────────────────────────
-avg_crisis_52_55      = pct.loc[CRISIS_52_55].mean()
-avg_expansion_56_69   = pct.loc[EXPANSION_56_69].mean()
-avg_recesion_70_81    = pct.loc[RECESION_70_81].mean()
-avg_crisis_82_85      = pct.loc[CRISIS_82_85].mean()
-avg_expansion_86_99   = pct.loc[EXPANSION_86_99].mean()
-avg_crisis_00_05      = pct.loc[CRISIS_00_05].mean()
-avg_acumulacion_06_13 = pct.loc[ACUMULACION_06_13].mean()
-avg_recesion_14_23    = pct.loc[RECESION_14_23].mean()
-
-#offsets
-hitos_offset = {
-    1951: (1, 0.10),
-    1955: (3, 0.05),
-    1969: (3, 0.05),
-    1981: (1, 0.10),
-    1985: (3, 0.05),
-    1999: (1, 0.10),
-    2005: (3, 0.05),
-    2014: (3, 0.05)
-}
-
-# ── 5. Gráfico stacked-bar ──────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(14, 7))
-
-# Mapeo de colores acorde a tus otras gráficas
-component_colors = [
-    "#1f77b4",  # gastos_consumo
-    "#ff7f0e",  # formacion_capital
-    "#2ca02c",  # exportacion_bienes_servicios
-    "#d62728",  # importacion_bienes
-    "#9467bd",  # consumo_privado
-    "#8c564b",  # consumo_publico
-]
-
-pct.plot(
-    kind="bar",
-    stacked=True,
-    ax=ax,
-    width=0.8,
-    color=component_colors
-)
-
-ax.set_ylabel("Participación en el PIB (%)")
-ax.set_xlabel("Año")
-ax.set_title(
-    "Participación de los componentes del PIB real (base 1990) por tipo de gasto\n1950–2023",
-    fontweight="bold"
-)
-
-# Leyenda fuera del área de gráfico
-ax.legend(
-    loc="upper center",
-    bbox_to_anchor=(0.5, -0.15),
-    ncol=3,
-    fontsize=10,
-    frameon=False
-)
-fig.subplots_adjust(bottom=0.25)
-
-# Etiquetas de años cada dos posiciones
-positions = np.arange(len(df.index))
-plt.xticks(positions[::2], df.index[::2], rotation=45)
-
-# ── 5.1 Hitos visuales ─────────────────────────────────────────────────────
-hitos_v = {
-    1951: "Crisis",
-    1955: "Expansión",
-    1969: "Recesión",
-    1981: "Crisis",
-    1985: "Expansión",
-    1999: "Crisis",
-    2005: "Expansión",
-    2014: "Recesión"
-}
-fig.subplots_adjust(right=0.72)
-
-for yr, lbl in hitos_v.items():
-    if yr in pct.index:
-        idx = pct.index.get_loc(yr)
-        y_max=ax.get_ylim()[1]
-        ax.axvline(
-            x=idx + 0.5, color="gray", ls="--", lw=1.5, zorder=5
-        )
-        dx,dy=hitos_offset.get(yr,(0,0.5))
-        ax.text(
-            idx + 0.5+dx,dy, lbl, rotation=0 if lbl=='Expansión' or lbl=='Recesión' else 90, ha="center", va="top",
-            fontsize=12, color="black",
-            transform=ax.get_xaxis_transform(), clip_on=False,
-            bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
-            zorder=6
-        )
-# Helper para anotar medias por ciclo sobre el grafico
-# ── Helper para anotar medias por ciclo ────────────────────────────────────
-# ── 0. Configura qué promedios mover u omitir ──────────────────────────────
-# 1️⃣  Desplazamientos (dx, dy) por ciclo-componente  (barras en X, puntos % en Y)
-# Desplazamientos sólo para “consumo_publico” en todos los ciclos
-MEAN_OFFSETS = {
-    CRISIS_52_55:      {'consumo_publico': (0.0, 12.0)},
-    EXPANSION_56_69:   {'consumo_publico': (0.0, 14.5)},
-    RECESION_70_81:    {'consumo_publico': (0.0, 14.5)},
-    CRISIS_82_85:      {'consumo_publico': (0.0, 12.0)},
-    EXPANSION_86_99:   {'consumo_publico': (0.0, 15.0)},
-    CRISIS_00_05:      {'consumo_publico': (0.0, 12.0)},
-    ACUMULACION_06_13: {'consumo_publico': (0.0, 12.0)},
-    RECESION_14_23:    {'consumo_publico': (0.0, 12.0)},
-}
-
-
-# 2️⃣  Componentes cuyos promedios NO quieres anotar
-SKIP_MEANS = {
-    CRISIS_52_55:      {'exportacion_bienes_servicios', 'importacion_bienes'}
-}
-
-def annotate_cycle_means(
-    ax, data, cycle_slice, cols,
-    offsets=None, skip=None,
-    fmt="{val:.0f}", **text_kw
-):
-    sub = data.loc[cycle_slice, cols]
-    if sub.empty:
-        return
-
-    means = sub.mean()
-    start_idx = data.index.get_loc(sub.index[0])
-    end_idx   = data.index.get_loc(sub.index[-1])
-    x_mid     = (start_idx + end_idx) / 2
-
-    cum = 0
-    for col in cols:
-        # omitir si el usuario lo indica
-        if skip and col in skip.get(cycle_slice, set()):
-            cum += means[col]
-            continue
-
-        val = means[col]
-        dx, dy = (0, 0)
-        if offsets:
-            dx, dy = offsets.get(cycle_slice, {}).get(col, (0, 0))
-
-        ax.text(
-            x_mid + dx,
-            cum + val/2 + dy,
-            fmt.format(val=val),
-            ha="center", va="center",
-            zorder=6,
-            **text_kw
-        )
-        cum += val
-# ── 5.2 Medias por ciclo ─────────────────────────────────────────────
-# ── 5.2 Medias por ciclo (con offsets y skips) ────────────────────────────
-cycles = [
-    CRISIS_52_55, EXPANSION_56_69, RECESION_70_81, CRISIS_82_85,
-    EXPANSION_86_99, CRISIS_00_05, ACUMULACION_06_13, RECESION_14_23,
-]
-for ciclo in cycles:
-    annotate_cycle_means(
-        ax, pct, ciclo, componentes,
-        offsets=MEAN_OFFSETS,
-        skip=SKIP_MEANS,
-        fontsize=13, color="black", fontweight="bold"
-    )
-
-
-
-# ── 6. Guardar y mostrar ───────────────────────────────────────────────────
-plt.tight_layout()
-out_path = os.path.join(OUTPUT_DIR, "participacion_pib_gasto.png")
-plt.savefig(out_path, dpi=300)
-plt.show()
-print(f"Imagen guardada en: {out_path}")
-
-
-# %%
-# ── 5.2 Medias por ciclo ─────────────────────────────────────────────────
-ciclos = {
-    CRISIS_52_55:      "M",   # usa la etiqueta que quieras mostrar
-    EXPANSION_56_69:   "M",
-    RECESION_70_81:    "M",
-    CRISIS_82_85:      "M",
-    EXPANSION_86_99:   "M",
-    CRISIS_00_05:      "M",
-    ACUMULACION_06_13: "M",
-    RECESION_14_23:    "M",
-}
-
-# orden consistente con el plot apilado
-order = componentes                       # ['gastos_consumo', 'formacion_capital', …]
-
-for ciclo_slice, texto in ciclos.items():
-    # índices (posiciones) del ciclo en el eje-x y su punto medio
-    pos_in_x = pct.index.get_indexer(pct.loc[ciclo_slice].index)
-    if len(pos_in_x) == 0:
-        continue                          # por si algún slice está fuera de rango
-    x_mid = pos_in_x.mean()
-
-    # promedio por componente (en % del PIB)
-    avg = pct.loc[ciclo_slice, order].mean()
-
-    # altura acumulada para colocar cada etiqueta al centro vertical de su franja
-    y_base = 0
-    for comp in order:
-        height = avg[comp]
-        y_center = y_base + height / 2
-
-        ax.text(
-            x_mid, y_center,                      # posición
-            f"{height:.1f}",                      # 1 decimal, ej. 23.4
-            ha="center", va="center",
-            fontsize=14, color="black",
-            rotation=0,                         # vertical para que no invada barras vecinas
-            fontweight="bold"
-        )
-        y_base += height    
-
-# %%
-import seaborn as sns
-# ── 1. Agrupar promedios por ciclo en DataFrame ──────────────────────────────
-df_means = pd.DataFrame({
-    #"Crisis 52–55":      avg_crisis_52_55,
-    "Expansión 56–69":   avg_expansion_56_69,
-    "Recesión 70–81":    avg_recesion_70_81,
-    #"Crisis 82–85":      avg_crisis_82_85,
-    "Expansión 86–99":   avg_expansion_86_99,
-    #"Crisis 00–05":      avg_crisis_00_05,
-    "Acumulación 06–13": avg_acumulacion_06_13,
-    "Recesión 14–23":    avg_recesion_14_23,
-}).round(1)
-
-# ── 2. Estilo y creación del heatmap ─────────────────────────────────────────
-plt.rcParams.update({
-    "font.family": "serif", "font.size": 12,
-    "axes.titlesize": 16, "axes.labelsize": 14,
-    "grid.linestyle": "--", "lines.linewidth": 2,
-    "figure.dpi": 150, "savefig.bbox": "tight"
-})
-
-fig, ax = plt.subplots(figsize=(12, 6))
-sns.heatmap(
-    df_means,
-    annot=True, fmt=".1f",
-    cmap="Blues",        # escala de grises sobria
-    cbar=False,
-    linewidths=0.5,
-    linecolor="lightgray",
-    ax=ax
-)
-
-ax.set_title(
-    "Promedios de participación de los componentes del PIB real\npor ciclo económico (1952–2023)",
-    fontweight='bold', pad=20
-)
-ax.set_ylabel("Componente de gasto")
-ax.set_xlabel("Periodo económico")
-ax.set_yticklabels(ax.get_yticklabels(), rotation=0)
-ax.set_xticklabels(ax.get_xticklabels(), rotation=45, ha='right')
-
-plt.tight_layout()
-out_file = os.path.join(OUTPUT_DIR, "tabla_promedios_pib_gasto_seaborn.png")
-plt.savefig(out_file,dpi=300)
-plt.show()
-
-print(f"Heatmap de estadísticas guardado en: {out_file}")
diff --git a/notebooks/tesis/serie_completa/pib/pib_por_ramas.py b/notebooks/tesis/serie_completa/pib/pib_por_ramas.py
deleted file mode 100644
index d139af3..0000000
--- a/notebooks/tesis/serie_completa/pib/pib_por_ramas.py
+++ /dev/null
@@ -1,438 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os, sys
-sys.path.append(os.path.abspath('../'))
-from graficos_utils import *
-from config import *
-
-
-
-# ── 1. Configuración general ─────────────────────────────────────────
-output_dir = "../../../../assets/tesis/serie_completa/pib"
-os.makedirs(output_dir, exist_ok=True)
-
-set_style()
-
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
-    df = (pd.read_sql('SELECT * FROM pib_ramas', conn, index_col='año')
-            .sort_index()) / 1000        # miles  → millones
-
-sectores = [
-    ("agropecuario",      "Agropecuario"),
-    ("mineria",           "Minería"),
-    ("petroleo",          "Petróleo"),
-    ("comercio_finanzas", "Comercio-Finanzas"),
-]
-cols_sectores = [col for col, _ in sectores]
-#estadisticas
-CYCLES_SIN_CRISIS = adjust_cycles(df, CYCLES_SIN_CRISIS)
-cycle_stats = {
-    name: df.loc[period, cols_sectores].mean().to_dict()
-    for name, period in CYCLES_SIN_CRISIS.items()
-}
-# ── 4. Hitos, años clave, offsets ────────────────────────────────────
-hitos_v = {
-    1950: "Expansion",
-    1971: "Recesion",
-    1985: "Expansion",
-    2005: "Expansion",
-    2015: "Recesion"
-}
-
-# añade (dx,dy) solo si quieres mover textos manualmente
-annotation_offsets = {
-    "agropecuario": {
-        1950: (0, 300), 1971: (0, 300), 1985: (-1.5, -450),
-        2005: (0, -300), 2015: (-0.5, 370),2022:(0,-500)
-    },
-    "mineria": {
-        1950: (0, 200), 1971: (-0.3, 400), 1985: (0, -320),
-        2005: (0, -250), 2015: (0, -350),2022:(0,-400)
-    },
-    "petroleo": {
-        1950: (0, -200), 1971: (0, -300),1985: (0.3, 300),
-        2005: (0, 270),
-        2015: (0, 220),
-        2022:(0,200)
-    },
-    "comercio_finanzas": {
-        1950: (0, -250), 1971: (0.8, -400), 1985: (1.5, 500),
-        2005: (0, 300),
-        2015: (-0.7, 600),
-        2022:(0,200)
-    },
-}
-# hitos_offset: año → fracción de eje Y (0–1) donde apoya la base del recuadro
-hitos_offset = {
-    1950: 0.45, 1971: 0.50, 1985: 0.50,
-    2005: 0.62, 2015: 0.48
-}
-text_offsets = {
-    "Expansión 50-70": (1958,  0.90),
-    "Recesión 71-84":  (1972,  0.90),
-    "Expansión 85-05": (1988,  0.90),
-    "Expansión 05-14": (2005.1,  0.99),
-    "Recesión 15-22": (2016.4,  0.85),
-}
-period_offsets = {
-    "1971-1984": (1972,  0.73),
-    "1985-2005": (1988,  0.73),
-    "2005-2014": (2005.1,  0.83),
-    "2015-2022": (2016.4, 0.52),
-}
-participation_offsets = {
-    "1950-1970": (1958, 0.56),
-    "1971-1984": (1972, 0.56),
-    "1985-2005": (1988, 0.56),
-    "2005-2014": (2005.1, 0.675),
-    "2015-2022": (2016, 0.14),
-}
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-custom_colors = {
-    "agropecuario":      "#1f77b4",  # blue
-    "mineria":           "#ff7f0e",  # orange
-    "petroleo":          "#2ca02c",  # green
-    "comercio_finanzas": "#8c564b",  # café
-}
-
-fig, ax = plt.subplots(figsize=(13,8))
-for col, label in sectores:
-    ax.plot(df.index, df[col],
-            label=label,
-            color=custom_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-add_hitos(ax, df.index, hitos_v_sin_crisis, hitos_offset)
-
-# ── 7. Anotaciones de valores ────────────────────────────────────────
-add_year_value_annotations(ax,df,annot_years_sin_crisis,cols_sectores,annotation_offsets, custom_colors)
-        
-# Mapa de tasas por año final
-periodos = [
-    (1971, 1984),
-    (1985, 2005),
-    (2005, 2014),
-    (2015,2022)
-]
-componentes = ["agropecuario", "mineria", "comercio_finanzas", "petroleo"]
-
-#cuadro de estadisticas
-# 8.1 Abreviaturas para las ramas
-abbr = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "petroleo":          "Pe",
-    "comercio_finanzas": "CF",
-}
-# 8.3 Colores de cada rama (mismo diccionario de la línea)
-component_colors = custom_colors
-# calcula y_max DESPUÉS de haber dibujado las series
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03          # 3 % de la altura
-
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr,
-    component_colors,
-    line_spacing=line_spacing,        # ← pasa el valor correcto
-)
-
-
-# 2. Parámetros de posición y estilo (sobre tu ax ya dibujado)
-y_max       = ax.get_ylim()[1]
-line_space  = y_max * 0.03
-# abreviaturas para cada componente
-abbr_comp   = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "comercio_finanzas": "CF",
-    "petroleo":          "Pe",
-}
-
-
-# 4. Loop para anotar cada cuadro de tasas
-add_period_growth_annotations_multi(
-    ax,df,
-    periodos,
-    [col for col,_ in sectores],
-    period_offsets,
-    component_colors,
-    abbr_comp,
-)
-periodos2=[
-    (1950,1971)
-]
-period_offsets2={
-    "1950-1971":(1956,0.73)
-}
-add_period_growth_annotations_multi(
-    ax,df,
-    periodos2,
-    ["agropecuario", "mineria", "comercio_finanzas"],
-    period_offsets2,
-    component_colors,
-    abbr_comp,
-)
-
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos,
-    cols_sectores,
-    "pib_real",
-    participation_offsets, 
-    abbr_comp, 
-    component_colors
-)
-
-participation_offsets2={
-    "1950-1971":(1956,0.59)
-}
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos2,
-    ["agropecuario", "mineria", "comercio_finanzas"],
-    "pib_real",
-    participation_offsets2, 
-    abbr_comp, 
-    component_colors
-)
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"PIB por Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=3, fontsize=12)
-# ── Pie de fuente ─────────────────────────────────────────────────────────
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
-)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "pib_rama_de_actividad_1.png"))
-plt.show()
-
-# %%
-df.head(21)
-
-# %%
-
-sectores = [
-    ("agropecuario",      "Agropecuario"),
-    ("mineria",           "Minería"),
-    ("petroleo",          "Petróleo"),
-    ("comercio_finanzas", "Comercio-Finanzas"),
-]
-cols_sectores = [col for col, _ in sectores]
-#estadisticas
-cycle_stats = {
-    name: df.loc[period, cols_sectores].mean().to_dict()
-    for name, period in CYCLES_PERIODOS.items()
-}
-
-
-
-anot_years = [1950,1985,2006,2022]
-
-# añade (dx,dy) solo si quieres mover textos manualmente
-annotation_offsets = {
-    "agropecuario": {
-        1950: (0, 300), 1985: (-1.5, -450),
-        2006: (0, -300), 2022:(0,200)
-    },
-    "mineria": {
-        1950: (0, 200), 1985: (0, -320),
-        2006: (0, -250), 2022:(0,-400)
-    },
-    "petroleo": {
-        1950: (0, -200), 1985: (0.3, 300),
-        2006: (0, 270),
-        2022:(0,200)
-    },
-    "comercio_finanzas": {
-        1950: (0, -250), 1985: (1.5, 500),
-        2006: (0, 300),
-        2022:(0,200)
-    },
-}
-period_offsets = {
-    "1950-1984": (1956,  0.60),
-    "1985-2005": (1988,  0.75),
-    "2006-2022": (2006,  0.75),
-}
-text_offsets = {
-    "1950-1984": (1956,  0.90),
-    "1985-2005":  (1988,  0.95),
-    "2006-2022": (2006,  0.95),
-
-}
-# hitos_offset: año → fracción de eje Y (0–1) donde apoya la base del recuadro
-hitos_offset = {
-    1950: 0.45, 1985: 0.50, 2006: 0.50,
-}
-participation_offsets = {
-    "1985-2005": (1988, 0.56),
-    "2006-2022": (2009.1, 0.15),
-}
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-custom_colors = {
-    "agropecuario":      "#1f77b4",  # blue
-    "mineria":           "#ff7f0e",  # orange
-    "petroleo":          "#2ca02c",  # green
-    "comercio_finanzas": "#8c564b",  # café
-}
-
-fig, ax = plt.subplots(figsize=(13,8))
-for col, label in sectores:
-    ax.plot(df.index, df[col],
-            label=label,
-            color=custom_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-
-
-# ── 7. Anotaciones de valores ────────────────────────────────────────
-add_hitos(ax, df.index, hitos_v_periodos, hitos_offset)
-add_year_value_annotations(ax,df,annot_years_periodos,cols_sectores,annotation_offsets, custom_colors)
-# Mapa de tasas por año final
-periodos = [
-    (1985, 2005),
-    (2006, 2022)
-]
-componentes = ["agropecuario", "mineria", "comercio_finanzas", "petroleo"]
-
-
-
-#cuadro de estadisticas
-# 8.1 Abreviaturas para las ramas
-abbr = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "petroleo":          "Pe",
-    "comercio_finanzas": "CF",
-}
-
-
-
-# 8.3 Colores de cada rama (mismo diccionario de la línea)
-component_colors = custom_colors
-
-
-# calcula y_max DESPUÉS de haber dibujado las series
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03          # 3 % de la altura
-
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr,
-    component_colors,
-    line_spacing=line_spacing,        # ← pasa el valor correcto
-)
-
-
-# 2. Parámetros de posición y estilo (sobre tu ax ya dibujado)
-y_max       = ax.get_ylim()[1]
-line_space  = y_max * 0.03
-# abreviaturas para cada componente
-abbr_comp   = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "comercio_finanzas": "CF",
-    "petroleo":          "Pe",
-}
-
-
-# 4. Loop para anotar cada cuadro de tasas
-add_period_growth_annotations_multi(
-    ax,df,
-    periodos,
-    [col for col,_ in sectores],
-    period_offsets,
-    component_colors,
-    abbr_comp,
-)
-periodos2=[
-    (1950,1984)
-]
-period_offsets2={
-    "1950-1984":(1956,0.73)
-}
-add_period_growth_annotations_multi(
-    ax,df,
-    periodos2,
-    ["agropecuario", "mineria", "comercio_finanzas"],
-    period_offsets2,
-    component_colors,
-    abbr_comp,
-)
-
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos,
-    cols_sectores,
-    "pib_real",
-    participation_offsets, 
-    abbr_comp, 
-    component_colors
-)
-participation_offsets2={
-    "1950-1984":(1956,0.59)
-}
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos2,
-    ["agropecuario", "mineria", "comercio_finanzas"],
-    "pib_real",
-    participation_offsets2, 
-    abbr_comp, 
-    component_colors
-)
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"PIB por Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=3, fontsize=12)
-# ── Pie de fuente ─────────────────────────────────────────────────────────
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
-)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "pib_rama_de_actividad_2.png"))
-plt.show()
diff --git a/notebooks/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py b/notebooks/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py
deleted file mode 100644
index d732d19..0000000
--- a/notebooks/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py
+++ /dev/null
@@ -1,438 +0,0 @@
-# ---
-# jupyter:
-#   jupytext:
-#     text_representation:
-#       extension: .py
-#       format_name: percent
-#       format_version: '1.3'
-#       jupytext_version: 1.17.2
-#   kernelspec:
-#     display_name: .venv
-#     language: python
-#     name: python3
-# ---
-
-# %%
-import pandas as pd
-import matplotlib.pyplot as plt
-import sqlite3, os
-import sys
-sys.path.append(os.path.abspath('../'))          # utilidades propias
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi,
-    add_participation_cycle_boxes
-)
-from config import *
-
-# ── 1. Configuración general y salida ────────────────────────────────
-output_dir = "../../../../assets/tesis/serie_completa/pib"
-os.makedirs(output_dir, exist_ok=True)
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family':'serif','font.size':12,
-    'axes.titlesize':16,'axes.labelsize':14,
-    'grid.linestyle':'--','lines.linewidth':2,
-    'figure.dpi':150,'savefig.bbox':'tight'
-})
-component_colors = {
-    'pib_real_base_1990': '#1f77b4'
-}
-# ── 2. Carga de datos ────────────────────────────────────────────────
-with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
-    df = pd.read_sql("SELECT * FROM pib_real_gasto", conn, index_col='año') / 1000
-
-# ── 3. Componentes y estadísticas ───────────────────────────────────
-componentes = [
-    ("gastos_consumo",               "Consumo total"),
-    ("formacion_capital",            "Inversión"),
-    ("exportacion_bienes_servicios", "Exportaciones"),
-    ("importacion_bienes",           "Importaciones"),
-    ("pib_real_base_1990",           "PIB real"),
-    ("consumo_privado",              "Consumo privado"),
-    ("consumo_publico",              "Consumo público"),
-]
-cycle_stats = {
-    name: df.loc[period].mean().to_dict()
-    for name, period in CYCLES_SIN_CRISIS.items()
-}
-
-# ── 4. Configuración de hitos y anotaciones ────────────────────────
-# Años donde dibujaremos líneas verticales
-hitos_v = {
-    1950: "Expansion",
-    1971: "Recesion",
-    1985: "Expansion",
-    2005: "Expansion",
-    2015: "Recesion"
-}
-
-# Años que queremos anotar en todas las series
-anot_years = [1950,1971,1985, 2005, 2015, 2023]
-
-# ── Offsets personalizados para cada componente y año ──────────────
-annotation_offsets = {
-    'gastos_consumo': {
-        1950: (-0.8,  3800), 1971: (1.5, 4900), 1985: (-0.5,  6000),
-        2005: (-1.2,  6000), 2015: (1.38,   5200),2023: (1.2, 1300),
-    },
-    'formacion_capital': {
-        1950: (-1.5, -6100), 1971: (1.5, -6100), 1985: (-1.5,  -6100),
-        2005: (-1.5,  -4500), 2015: (1.5,  -6100), 2023: (1.2, -1100),
-    },
-    'exportacion_bienes_servicios': {
-        1950: (-3,  -3000), 1971: (3, -3000), 1985: (-3, -3000),
-        2005: (-1.9,    0), 2015: (0,   3000),2023: (1.2, -900),
-    },
-    'importacion_bienes': {
-        1950: (-2, -4600), 1971: (2, -4600), 1985: (-2, -4600),
-        2005: (-2, -6500), 2015: (2,   -6500),2023: (1.9, 1000),
-    },
-    'pib_real_base_1990': {
-        1950: (-0.8,  4900), 1971: (2, 5900), 1985: (-0.5,  6300),
-        2005: (-1.2,  5500), 2015: (0.7,    5500),2023: (1.2, 1200),
-    },
-    'consumo_privado': {
-        1950: (-2, 2500), 1971: (-2.3, 6200), 1985: (-0.5,  5100),
-        2005: (-1.2,  4900), 2015: (1,   -1900),2023: (1.2,  800),
-    },
-    'consumo_publico': {
-        1950: (-0.8, -7000), 1971: (0.8, -7100), 1985: (-0.8,  -7100),
-        2005: (-0.8, -7000), 2015: (0.8,    -7000),2023: (1.2,  600)
-    },
-}
-hitos_offset = {
-    1950: 0.45, 1971: 0.5, 1985: 0.5,
-    2005: 0.70, 2015: 0.55,
-}
-text_offsets = {
-    "Expansión 50-70": (1960, 0.85),
-    "Recesión 71-84":  (1972, 0.98),
-    "Expansión 85-05": (1990, 0.98),
-    "Expansión 06-14": (2006.3, 0.98),
-    "Recesión 15-22":  (2018, 0.6),
-}
-
-period_offsets: dict[str, tuple[float, float]] = {
-    '1950-1970': (1960, 0.58),
-    '1971-1984': (1972, 0.71),
-    '1985-2005': (1990, 0.71),
-    '2006-2014': (2006, 0.71),
-    '2015-2023': (2018, 0.35),
-}
-participation_offsets = {
-    "1950-1970": (1960, 0.50),
-    "1971-1984": (1972, 0.63),
-    "1985-2005": (1990, 0.63),
-    "2006-2014": (2006, 0.05),
-    "2015-2022": (2018, 0.1),
-}
-# ── 8.4 Ubicación de cuadros dentro de la gráfica ─────────────────────────
-
-cmap = plt.get_cmap("tab10")
-
-component_colors = {
-    "gastos_consumo":               cmap(4),  # azul     → CT  
-    "formacion_capital":            cmap(1),  # naranja  → Inv  
-    "exportacion_bienes_servicios": cmap(2),  # verde    → X  
-    "importacion_bienes":           cmap(3),  # rojo     → M  
-    "pib_real_base_1990":           cmap(0),  # morado   → PIB  
-    "consumo_privado":              cmap(5),  # marrón   → Cp  
-    "consumo_publico":              cmap(6),  # rosa     → Cg  
-}
-# ── 5. Crear figura y trazar ────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15,8))
-
-for i,(col,label) in enumerate(componentes):
-    ax.plot(df.index, df[col], label=label, color=component_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-#7 anotaciones
-add_year_value_annotations(
-    ax,
-    df,
-    years=anot_years,
-    columnas=[col for col, _ in componentes],
-    annotation_offsets=annotation_offsets,
-    colors=component_colors,
-    arrow_lw=0.2
-)
-
-# Mapa de tasas por año final
-periodos_tasas = [
-    (1950, 1970),
-    (1971, 1984),
-    (1985, 2005),
-    (2006, 2014),
-    (2015, 2023),
-]
-periodos_participacion = [
-    (1950, 1970),
-    (1971, 1984),
-    (1985, 2005),
-    (2006, 2014),
-    (2015, 2022),
-]
-
-
-
-# ── 8.1 Diccionario de abreviaturas ─────────────────────────────────────
-abbr = {
-    "gastos_consumo":               "CT",
-    "formacion_capital":            "Inv",
-    "exportacion_bienes_servicios": "X",
-    "importacion_bienes":           "M",
-    "pib_real_base_1990":           "PIB",
-    "consumo_privado":              "Cp",
-    "consumo_publico":              "Cg",
-}
-
-add_period_growth_annotations_multi(
-    ax, df, periodos_tasas,
-    cols=['pib_real_base_1990'],
-    period_offsets=period_offsets,
-    colors=component_colors,
-    abbr_map={'pib_real_base_1990': 'PIB'},
-)
-
-
-
-
-
-# ── 8.4 Ubicar y colorear estadísticas dentro de la gráfica ────────────
-y_max = ax.get_ylim()[1]
-# distancia vertical entre líneas de texto (en unidades de datos)
-line_spacing = y_max * 0.030
-
-
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr_map=abbr,
-    colors=component_colors,
-    line_spacing=line_spacing
-)
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos_participacion,
-    [ 'gastos_consumo', 'formacion_capital', 'exportacion_bienes_servicios', 'importacion_bienes', 'consumo_privado', 'consumo_publico'],
-    'pib_real_base_1990',
-    participation_offsets,
-    abbr,
-    component_colors,
-)
-# ── 9. Formato final ────────────────────────────────────────────────
-ax.set_title(f"PIB y Componentes ({df.index[0]}–{df.index[-1]})", fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=2)
-ax.set_ylim(-9000, df.max().max() * 1.05)
-
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
-)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "pib_componentes_1.png"))
-plt.show()
-
-
-
-# %%
-cycle_stats = {
-    name: df.loc[period].mean().to_dict()
-    for name, period in CYCLES_PERIODOS.items()
-}
-# ── 4. Configuración de hitos y anotaciones ────────────────────────
-# Años donde dibujaremos líneas verticales
-hitos_v = {
-    1950: "1950-1984",
-    1985: "1985-2005",
-    2006: "2006-2023",
-}
-
-# Años que queremos anotar en todas las series
-anot_years = [1950,1985,2006,2022]
-
-# ── Offsets personalizados para cada componente y año ──────────────
-annotation_offsets = {
-    "gastos_consumo": {
-        1950: (-0.8,  3800),
-        1985: (-0.5,  6000),
-        2006: (-1.2,  6000),   # mismo offset que en 2005
-        2022: (1.2,   1300),   # mismo offset que en 2023
-    },
-    "formacion_capital": {
-        1950: (-1.5, -6100),
-        1985: (-1.5, -6100),
-        2006: (-1.5, -4500),   # mismo offset que en 2005
-        2022: (1.2,  -1100),   # mismo offset que en 2023
-    },
-    "exportacion_bienes_servicios": {
-        1950: (-3,   -3000),
-        1985: (-3,   -3000),
-        2006: (-1.9,     0),   # mismo offset que en 2005
-        2022: (1.2,   -900),   # mismo offset que en 2023
-    },
-    "importacion_bienes": {
-        1950: (-2,   -4600),
-        1985: (-2,   -4600),
-        2006: (-2,   -6500),   # mismo offset que en 2005
-        2022: (1.2,   1000),   # mismo offset que en 2023
-    },
-    "pib_real_base_1990": {
-        1950: (-0.8,  4900),
-        1985: (-0.5,  6300),
-        2006: (-1.2,  5500),   # mismo offset que en 2005
-        2022: (1.2,   1200),   # mismo offset que en 2023
-    },
-    "consumo_privado": {
-        1950: (-2,    2500),
-        1985: (-0.5,  5100),
-        2006: (-1.2,  4900),   # mismo offset que en 2005
-        2022: (1.2,    800),   # mismo offset que en 2023
-    },
-    "consumo_publico": {
-        1950: (-0.8, -7000),
-        1985: (-0.8, -7100),
-        2006: (-0.8, -7000),   # mismo offset que en 2005
-        2022: (1.2,    600),   # mismo offset que en 2023
-    },
-}
-hitos_offset = {
-    1950: 0.45, 1985: 0.5, 2006: 0.5,
-    2022: 0.70,
-}
-text_offsets = {
-    "1950-1984": (1960, 0.85),
-    "1985-2005":  (1994, 0.75),
-    "2006-2022": (2018, 0.57),
-}
-period_offsets: dict[str, tuple[float, float]] = {
-    '1950-1984': (1960, 0.55),
-    '1985-2005': (1994, 0.49),
-    '2006-2022': (2018, 0.01),
-}
-participation_offsets = {
-    "1950-1984": (1960, 0.50),
-    "1985-2005": (1988, 0.56),
-    "2006-2022": (2009.1, 0.15),
-}
-# ── 8.4 Ubicación de cuadros dentro de la gráfica ─────────────────────────
-
-cmap = plt.get_cmap("tab10")
-
-component_colors = {
-    "gastos_consumo":               cmap(4),  # azul     → CT  
-    "formacion_capital":            cmap(1),  # naranja  → Inv  
-    "exportacion_bienes_servicios": cmap(2),  # verde    → X  
-    "importacion_bienes":           cmap(3),  # rojo     → M  
-    "pib_real_base_1990":           cmap(0),  # morado   → PIB  
-    "consumo_privado":              cmap(5),  # marrón   → Cp  
-    "consumo_publico":              cmap(6),  # rosa     → Cg  
-}
-# ── 5. Crear figura y trazar ────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15,8))
-
-for i,(col,label) in enumerate(componentes):
-    ax.plot(df.index, df[col], label=label, color=component_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-#7 anotaciones
-add_year_value_annotations(
-    ax,
-    df,
-    years=anot_years,
-    columnas=[col for col, _ in componentes],
-    annotation_offsets=annotation_offsets,
-    colors=component_colors,
-    arrow_lw=0.2
-)
-
-
-
-
-
-
-# ── 8.1 Diccionario de abreviaturas ─────────────────────────────────────
-abbr = {
-    "gastos_consumo":               "CT",
-    "formacion_capital":            "Inv",
-    "exportacion_bienes_servicios": "X",
-    "importacion_bienes":           "M",
-    "pib_real_base_1990":           "PIB",
-    "consumo_privado":              "Cp",
-    "consumo_publico":              "Cg",
-}
-
-add_period_growth_annotations_multi(
-    ax, df, periodos_tasas_periodos,
-    cols=['pib_real_base_1990'],
-    period_offsets=period_offsets,
-    colors=component_colors,
-    abbr_map={'pib_real_base_1990': 'PIB'},
-)
-
-
-# ── 8.4 Ubicar y colorear estadísticas dentro de la gráfica ────────────
-y_max = ax.get_ylim()[1]
-# distancia vertical entre líneas de texto (en unidades de datos)
-line_spacing = y_max * 0.030
-
-
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr_map=abbr,
-    colors=component_colors,
-    line_spacing=line_spacing
-)
-periodos_participacion = [
-    (1950, 1984),
-    (1985, 2005),
-    (2006, 2022),
-]
-add_participation_cycle_boxes(
-    ax,
-    df,
-    periodos_participacion,
-    [ 'gastos_consumo', 'formacion_capital', 'exportacion_bienes_servicios', 'importacion_bienes', 'consumo_privado', 'consumo_publico'],
-    'pib_real_base_1990',
-    participation_offsets,
-    abbr,
-    component_colors,
-)
-
-# ── 9. Formato final ────────────────────────────────────────────────
-ax.set_title(f"PIB y Componentes ({df.index[0]}–{df.index[-1]})", fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=2)
-ax.set_ylim(-7000, df.max().max() * 1.05)
-
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
-)
-
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "pib_componentes_2.png"))
-plt.show()
-
-
diff --git a/scripts/tesis/serie_completa/IDH/idh.py b/scripts/tesis/serie_completa/IDH/idh.py
new file mode 100644
index 0000000..95b00e0
--- /dev/null
+++ b/scripts/tesis/serie_completa/IDH/idh.py
@@ -0,0 +1,160 @@
+# ---
+# jupyter:
+#   jupytext:
+#     text_representation:
+#       extension: .py
+#       format_name: percent
+#       format_version: '1.3'
+#       jupytext_version: 1.17.2
+#   kernelspec:
+#     display_name: .venv
+#     language: python
+#     name: python3
+# ---
+
+# %%
+# ─────────────────────────────────────────────────────────────
+# Importaciones comunes
+# ─────────────────────────────────────────────────────────────
+import sys, os, sqlite3
+import numpy as np
+import pandas as pd
+import matplotlib.pyplot as plt
+
+sys.path.append(os.path.abspath('../'))  # utilidades propias
+from graficos_utils import *
+from config import (
+    # Con‑crisis
+    CYCLES, annot_years, periodos_tasas, hitos_v,
+    # Sin‑crisis
+    CYCLES_SIN_CRISIS, annot_years_sin_crisis,
+    periodos_tasas_sin_crisis, hitos_v_sin_crisis,
+    # Periodos estructurales
+    CYCLES_PERIODOS, annot_years_periodos,
+    periodos_tasas_periodos, hitos_v_periodos,
+)
+
+# Directorio de salida y estilo global
+output_dir = "../../../../assets/tesis/serie_completa/ingresos_idh"
+os.makedirs(output_dir, exist_ok=True)
+set_style()
+
+# ─────────────────────────────────────────────────────────────
+# Carga de datos: ingresos_nacionales.total_idh
+# ─────────────────────────────────────────────────────────────
+with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
+    df = (
+        pd.read_sql('SELECT año, total_idh FROM ingresos_nacionales', conn)
+          .set_index('año')
+          .sort_index()
+    )
+
+# ─────────────────────────────────────────────────────────────
+# Componentes comunes
+# ─────────────────────────────────────────────────────────────
+componentes = [('total_idh', 'Total IDH')]
+cols_componentes = ['total_idh']
+abbr_map = {'total_idh': 'IDH'}
+custom_colors = {'total_idh': '#1f77b4'}  # azul
+
+# ============================================================
+# 1) PRIMERA GRÁFICA — CON CRISIS
+# ============================================================
+annotate_years       = adjust_annot_years(df, annot_years)
+cycles_stats         = {n: df.loc[s, cols_componentes].mean().to_dict()
+                        for n, s in adjust_cycles(df, CYCLES).items()}
+periodos             = adjust_periods(df, periodos_tasas)
+
+annotation_offsets   = {
+    'total_idh': {
+        2001: (0, -200),
+        2006: (0, -250),
+        2014: (0, -300),
+        2023: (0, -350),
+    }
+}
+
+hitos_offset         = {a: 0.8 for a in hitos_v}
+medias_offsets       = {
+    'Crisis 01-05':    (2001, 1),
+    'Expansión 06-13': (2006, 1),
+    'Recesión 14-23':  (2014, 1),
+}
+
+tasas_offsets = {
+    '2006-2014': (2010, 0.83),
+    '2014-2023': (2018, 0.65),
+}
+
+fig, ax = init_base_plot(
+    df, componentes, custom_colors,
+    "Ingresos IDH (2001–2023) — Ciclos con Crisis",
+    "Año", "Millones de bolivianos",
+    source_text="Fuente: UDAPE"
+)
+add_hitos(ax, df.index, hitos_v, hitos_offset, line_kwargs={'lw': 0.9})
+add_cycle_means_multi(ax, cycles_stats, medias_offsets, abbr_map, custom_colors,
+                      line_spacing=ax.get_ylim()[1]*0.03)
+add_year_value_annotations(ax, df, annotate_years, cols_componentes,
+                           annotation_offsets, custom_colors, arrow_lw=0.5)
+add_period_growth_annotations_multi(ax, df, periodos, cols_componentes,
+                                    tasas_offsets, custom_colors, abbr_map)
+
+ax.set_ylim(-300, df['total_idh'].max()*1.15)
+plt.savefig(os.path.join(output_dir, "idh_ciclos.png"))
+plt.show()
+plt.close()
+
+# %%
+df.loc[2006:2014,'total_idh'].mean()
+
+# %%
+df.loc[2015:2023,'total_idh'].mean()
+
+# %%
+# ============================================================
+# 3) TERCERA GRÁFICA — PERIODOS ESTRUCTURALES
+# ============================================================
+annotate_years_periodos = adjust_annot_years(df_idh, annot_years_periodos)
+cycles_stats_periodos   = {n: df_idh.loc[s, cols_componentes].mean().to_dict()
+                           for n, s in adjust_cycles(df_idh, CYCLES_PERIODOS).items()}
+periodos_periodos       = adjust_periods(df_idh, periodos_tasas_periodos)
+
+annotation_offsets_periodos = {
+    'total_idh': {
+        2001: (0, -200),
+        2006: (0, -250),
+        2022: (0, -320),
+    }
+}
+
+hitos_offset_periodos       = {a: 0.8 for a in hitos_v_periodos}
+medias_offsets_periodos     = {
+    'Neoliberalismo 01-05':   (2001, 1),
+    'Neodesarrollismo 06-23': (2006, 1),
+}
+
+tasas_offsets_periodos = {
+    '2006-2023': (2014, 0.65),
+}
+# Gráfica
+fig, ax = init_base_plot(
+    df_idh, componentes, custom_colors,
+    "IDH (1985–2024) — Periodos Económicos",
+    "Año", "Puntos de IDH",
+    source_text="Fuente: UDAPE"
+)
+add_hitos(ax, df_idh.index, hitos_v_periodos, hitos_offset_periodos,
+          annotate_labels=tuple(), line_kwargs={'lw': 0.9})
+add_cycle_means_multi(ax, cycles_stats_periodos, medias_offsets_periodos,
+                      abbr_map, custom_colors, line_spacing=ax.get_ylim()[1]*0.03)
+add_year_value_annotations(ax, df_idh, annotate_years_periodos, cols_componentes,
+                           annotation_offsets_periodos, custom_colors, arrow_lw=0.5)
+add_period_growth_annotations_multi(ax, df_idh, periodos_periodos, cols_componentes,
+                                    tasas_offsets_periodos, custom_colors, abbr_map)
+
+ax.set_ylim(-300, df_idh['total_idh'].max()*1.15)
+plt.savefig(os.path.join(output_dir, "idh_periodos.png"))
+plt.show()
+plt.close()
+
diff --git a/scripts/tesis/serie_completa/deuda/deuda_externa.py b/scripts/tesis/serie_completa/deuda/deuda_externa.py
new file mode 100644
index 0000000..f1cb9fe
--- /dev/null
+++ b/scripts/tesis/serie_completa/deuda/deuda_externa.py
@@ -0,0 +1,315 @@
+# ---
+# jupyter:
+#   jupytext:
+#     text_representation:
+#       extension: .py
+#       format_name: percent
+#       format_version: '1.3'
+#       jupytext_version: 1.17.2
+#   kernelspec:
+#     display_name: .venv
+#     language: python
+#     name: python3
+# ---
+
+# %%
+# ─────────────────────────────────────────────────────────────────────
+# Importaciones
+# ─────────────────────────────────────────────────────────────────────
+import sys, os, sqlite3
+import numpy as np
+import pandas as pd
+import matplotlib.pyplot as plt
+
+# Añadir ruta para utils propios
+sys.path.append(os.path.abspath('../'))
+from graficos_utils import *
+from config import *  # trae CYCLES, annot_years, periodos_tasas, hitos_v …
+
+# ─────────────────────────────────────────────────────────────────────
+# Configuración general
+# ─────────────────────────────────────────────────────────────────────
+output_dir = "../../../../assets/tesis/serie_completa/deuda_externa"
+os.makedirs(output_dir, exist_ok=True)
+set_style()
+
+# ─────────────────────────────────────────────────────────────────────
+# Carga de datos
+# ─────────────────────────────────────────────────────────────────────
+with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
+    df = (
+        pd.read_sql('SELECT * FROM deuda_externa_total', conn)
+          .set_index('año')
+          .sort_index()
+    )
+
+# ─────────────────────────────────────────────────────────────────────
+# Componentes y abreviaturas (un solo componente)
+# ─────────────────────────────────────────────────────────────────────
+componentes = [
+    ('deuda', 'Deuda externa total'),
+]
+cols_componentes = ['deuda']
+abbr_map = {'deuda': 'Deuda'}
+
+# ─────────────────────────────────────────────────────────────────────
+# Preparación
+# ─────────────────────────────────────────────────────────────────────
+annotate_years   = adjust_annot_years(df, annot_years)
+CYCLES           = adjust_cycles(df, CYCLES)
+cycle_stats      = {n: df.loc[sli, cols_componentes].mean().to_dict()
+                    for n, sli in CYCLES.items()}
+periodos         = adjust_periods(df, periodos_tasas)
+
+custom_colors = {'deuda': '#1f77b4'}
+
+# ─────────────────────────────────────────────────────────────────────
+# Offsets (adaptados a la serie de deuda)
+# ─────────────────────────────────────────────────────────────────────
+annotation_offsets = {
+    'deuda': {
+        1952: (0, -200),
+        1956: (0, -200),
+        1970: (0, -200),
+        1982: (0, -200),
+        1986: (0, -200),
+        2000: (0, -250),
+        2006: (0, -250),
+        2014: (0, -300),
+        2023: (0, -300),
+    },
+}
+
+hitos_offset = {a: 0.8 for a in hitos_v}
+
+medias_offsets = {
+    'Crisis 52-55':      (1952, 1),
+    'Expansión 56-69':   (1956, 1),
+    'Recesión 70-81':    (1970, 1),
+    'Crisis 82-85':      (1982, 1),
+    'Expansión 86-99':   (1986, 1),
+    'Crisis 00-05':      (2000, 1),
+    'Expansión 06-13':   (2006, 1),
+    'Recesión 14-24':    (2014, 1),
+}
+
+tasas_offsets = {
+    '1956-1970': (1963, 0.83),
+    '1970-1986': (1976, 0.83),
+    '1986-2000': (1993, 0.83),
+    '2000-2006': (2003, 0.83),
+    '2006-2014': (2010, 0.83),
+    '2014-2022': (2018, 0.65),
+}
+
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Deuda Externa Total de Bolivia (1951–2020)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: BCB (1951–1996), UDAPE (1996–2020)"
+)
+
+add_hitos(ax, df.index, hitos_v, hitos_offset, line_kwargs={'linewidth': 0.9})
+
+add_cycle_means_multi(
+    ax, cycle_stats, medias_offsets,
+    abbr_map, custom_colors,
+    line_spacing=ax.get_ylim()[1] * 0.03
+)
+
+add_year_value_annotations(
+    ax, df, annotate_years,
+    cols_componentes, annotation_offsets,
+    custom_colors, arrow_lw=0.5
+)
+
+add_period_growth_annotations_multi(
+    ax, df, periodos,
+    cols_componentes, tasas_offsets,
+    custom_colors, abbr_map
+)
+# Margen inferior para valores negativos en offset (si se usan) y margen superior
+ax.set_ylim(-600, df['deuda'].max() * 1.15)
+
+plt.savefig(os.path.join(output_dir, "deuda_externa_total.png"))
+plt.show()
+
+# %%
+# ─────────────────────────────────────────────────────────────────────
+# Preparación “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+# 1) Años anotados
+annotate_years_sin_crisis = adjust_annot_years(df, annot_years_sin_crisis)
+# 2) Ciclos sin crisis
+CYCLE_SC = adjust_cycles(df, CYCLES_SIN_CRISIS)
+cycle_stats_sin_crisis= {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLE_SC.items()
+}
+# 3) Periodos para tasas sin crisis
+periodos_sin_crisis = adjust_periods(df, periodos_tasas_sin_crisis)
+
+
+# ─────────────────────────────────────────────────────────────────────
+# Offsets “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+annotation_offsets_sin_crisis = {
+    'deuda': {
+        1952: (0, -200),
+        1971: (0, -200),
+        1985: (0, -200),
+        2005: (0, -250),
+        2015: (0, -300),
+        2022: (0, -350),
+    },
+}
+hitos_offset_sin_crisis = {y: 0.8 for y in hitos_v_sin_crisis}
+medias_offsets_sin_crisis = {
+    'Expansión 51-70':   (1956, 1),
+    'Recesión 71-84':    (1970, 1),
+    'Expansión 85-05':   (1986, 1),
+    'Expansión 06-14':   (2006, 1),
+    'Recesión 15-20':    (2014, 1),
+}
+tasas_offsets_sin_crisis = {
+    '1951-1970': (1963, 0.83),
+    '1971-1984': (1976, 0.83),
+    '1985-2005': (1993, 0.83),
+    '2006-2014': (2010, 0.83),
+    '2015-2020': (2018, 0.65),
+}
+
+
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Deuda Externa Total sin Crisis (1951–2020)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: BCB (1951–1996), UDAPE (1996–2020)"
+)
+
+add_hitos(
+    ax, df.index, hitos_v_sin_crisis, hitos_offset_sin_crisis,
+    line_kwargs={'linewidth': 0.9}
+)
+add_cycle_means_multi(
+    ax,cycle_stats_sin_crisis, medias_offsets_sin_crisis,
+    abbr_map, custom_colors,
+    line_spacing=ax.get_ylim()[1] * 0.03
+)
+add_year_value_annotations(
+    ax, df,
+    annotate_years_sin_crisis,
+    cols_componentes,
+    annotation_offsets_sin_crisis,
+    custom_colors,
+    arrow_lw=0.5
+)
+
+add_period_growth_annotations_multi(
+    ax, df,
+    periodos_sin_crisis,
+    cols_componentes,
+    tasas_offsets_sin_crisis,
+    custom_colors,
+    abbr_map
+)
+
+
+ax.set_ylim(-400, df['deuda'].max() * 1.15)
+plt.savefig(os.path.join(output_dir, "deuda_externa_total_sin_crisis.png"))
+plt.show()
+
+# %%
+# ─────────────────────────────────────────────────────────────────────
+# Preparación “por periodos”
+# ─────────────────────────────────────────────────────────────────────
+# 1) Años anotados
+annotate_years_periodos = adjust_annot_years(df, annot_years_periodos)
+# 2) Ciclos periodos
+CYCLES_P = adjust_cycles(df, CYCLES_PERIODOS)
+cycles_stats_periodos = {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES_P.items()
+}
+# 3) Periodos para tasas
+periodos_periodos = adjust_periods(df, periodos_tasas_periodos)
+
+
+# ─────────────────────────────────────────────────────────────────────
+# Offsets “periodos”
+# ─────────────────────────────────────────────────────────────────────
+annotation_offsets_periodos = {
+    'deuda': {year: (0, -250) for year in annot_years_periodos}
+}
+hitos_offset_periodos = {y: 0.8 for y in hitos_v_periodos}
+medias_offsets_periodos = {
+    'Intervensionismo-estatal 51-84': (1950, 1),
+    'Neoliberalismo 85-05':           (1985, 1),
+    'Neodesarrollismo 06-20':         (2006, 1),
+}
+tasas_offsets_periodos = {
+    '1951-1984': (1967, 0.83),
+    '1985-2005': (1995, 0.83),
+    '2006-2020': (2014, 0.63),
+}
+
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica “por periodos”
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Deuda Externa Total por Periodo Económico (1951–2020)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: BCB (1951–1996), UDAPE (1996–2020)"
+)
+
+# Líneas de hitos
+add_hitos(
+    ax, df.index, hitos_v_periodos, hitos_offset_periodos,
+    annotate_labels=tuple(), line_kwargs={'linewidth': 1.0}
+)
+
+# Medias por periodo
+y_max = ax.get_ylim()[1]
+add_cycle_means_multi(
+    ax, cycles_stats_periodos, medias_offsets_periodos,
+    abbr_map, custom_colors, line_spacing=y_max * 0.03
+)
+
+# Valores puntuales
+add_year_value_annotations(
+    ax, df,
+    annotate_years_periodos,
+    cols_componentes,
+    annotation_offsets_periodos,
+    custom_colors, arrow_lw=0.5
+)
+
+# Tasas de crecimiento
+add_period_growth_annotations_multi(
+    ax, df,
+    periodos_periodos,
+    cols_componentes,
+    tasas_offsets_periodos,
+    custom_colors,
+    abbr_map
+)
+
+plt.savefig(os.path.join(output_dir, "deuda_externa_total_periodos.png"))
+plt.show()
+
diff --git a/scripts/tesis/serie_completa/deuda/deuda_interna.py b/scripts/tesis/serie_completa/deuda/deuda_interna.py
new file mode 100644
index 0000000..ddbfb2b
--- /dev/null
+++ b/scripts/tesis/serie_completa/deuda/deuda_interna.py
@@ -0,0 +1,207 @@
+# ---
+# jupyter:
+#   jupytext:
+#     text_representation:
+#       extension: .py
+#       format_name: percent
+#       format_version: '1.3'
+#       jupytext_version: 1.17.2
+#   kernelspec:
+#     display_name: .venv
+#     language: python
+#     name: python3
+# ---
+
+# %%
+# ─────────────────────────────────────────────────────────────
+# Importaciones comunes
+# ─────────────────────────────────────────────────────────────
+import sys, os, sqlite3
+import numpy as np
+import pandas as pd
+import matplotlib.pyplot as plt
+
+sys.path.append(os.path.abspath('../'))  # utilidades propias
+from graficos_utils import *
+from config import (
+    # Con‑crisis
+    CYCLES, annot_years, periodos_tasas, hitos_v,
+    # Sin‑crisis
+    CYCLES_SIN_CRISIS, annot_years_sin_crisis,
+    periodos_tasas_sin_crisis, hitos_v_sin_crisis,
+    # Periodos estructurales
+    CYCLES_PERIODOS, annot_years_periodos,
+    periodos_tasas_periodos, hitos_v_periodos,
+)
+
+# Directorio de salida y estilo global
+output_dir = "../../../../assets/tesis/serie_completa/deuda_interna"
+os.makedirs(output_dir, exist_ok=True)
+set_style()
+
+# ─────────────────────────────────────────────────────────────
+# Carga de datos
+# ─────────────────────────────────────────────────────────────
+with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
+    df_di = (
+        pd.read_sql('SELECT * FROM deuda_interna', conn)
+          .set_index('año')
+          .sort_index()
+    )
+
+# ─────────────────────────────────────────────────────────────
+# Componentes comunes
+# ─────────────────────────────────────────────────────────────
+componentes = [('valor', 'Deuda interna total')]
+cols_componentes = ['valor']
+abbr_map = {'valor': 'Deuda int.'}
+custom_colors = {'valor': '#d62728'}
+
+
+# ============================================================
+# 1) PRIMERA GRÁFICA — CON CRISIS
+# ============================================================
+# Preparación
+annotate_years       = adjust_annot_years(df_di, annot_years)
+cycles_stats         = {n: df_di.loc[s, cols_componentes].mean().to_dict()
+                        for n, s in adjust_cycles(df_di, CYCLES).items()}
+periodos             = adjust_periods(df_di, periodos_tasas)
+
+# Offsets
+annotation_offsets = {
+    'valor': {
+        1992: (0, 150), 2000: (0, 150), 2006: (0, 150),
+        2014: (0.5, 150), 2024: (1, 150),
+    }
+}
+hitos_offset         = {a: 0.8 for a in hitos_v}
+medias_offsets       = {
+    'Expansión 93-99': (1993, 1),
+    'Crisis 00-05':    (2000, 1),
+    'Expansión 06-13': (2006, 1),
+    'Recesión 14-22':  (2014, 1),
+}
+tasas_offsets        = {
+    '1993-2000': (1993, 0.83),
+    '2000-2006': (2003, 0.83),
+    '2006-2014': (2010, 0.83),
+    '2014-2022': (2018, 0.65),
+}
+
+# Gráfica
+fig, ax = init_base_plot(
+    df_di, componentes, custom_colors,
+    "Deuda Interna TGÑ (1993–2022) — Ciclos con Crisis",
+    "Año", "Millones de dólares",
+    source_text="Fuente: UDAPE"
+)
+add_hitos(ax, df_di.index, hitos_v, hitos_offset, line_kwargs={'lw': 0.9})
+add_cycle_means_multi(ax, cycles_stats, medias_offsets, abbr_map, custom_colors,
+                      line_spacing=ax.get_ylim()[1]*0.03)
+add_year_value_annotations(ax, df_di, annotate_years, cols_componentes,
+                           annotation_offsets, custom_colors, arrow_lw=0.5)
+add_period_growth_annotations_multi(ax, df_di, periodos, cols_componentes,
+                                    tasas_offsets, custom_colors, abbr_map)
+
+ax.set_ylim(-300, df_di['valor'].max()*1.15)
+plt.savefig(os.path.join(output_dir, "deuda_interna_ciclos.png"))
+plt.show()
+plt.close()
+
+
+# %%
+# ============================================================
+# 2) SEGUNDA GRÁFICA — SIN CRISIS
+# ============================================================
+# Preparación
+annotate_years_sin_crisis = adjust_annot_years(df_di, annot_years_sin_crisis)
+cycles_stats_sin_crisis   = {n: df_di.loc[s, cols_componentes].mean().to_dict()
+                             for n, s in adjust_cycles(df_di, CYCLES_SIN_CRISIS).items()}
+periodos_sin_crisis       = adjust_periods(df_di, periodos_tasas_sin_crisis)
+
+# Offsets
+annotation_offsets_sin_crisis = {
+    'valor': {
+        1993: (0, 500), 2005: (0, 500), 2015: (0, 500), 2022: (0, 500)
+    }
+}
+hitos_offset_sin_crisis       = {a: 0.8 for a in hitos_v_sin_crisis}
+medias_offsets_sin_crisis     = {
+    'Expansión 93-05': (1993, 1),
+    'Expansión 06-14': (2006, 1),
+    'Recesión 15-22':  (2014, 1),
+}
+tasas_offsets_sin_crisis = {
+    '1993-2005': (1993, 1.05),
+    '2006-2014': (2006, 1.05),
+    '2015-2022': (2015, 1.05)
+}
+
+# Gráfica
+fig, ax = init_base_plot(
+    df_di, componentes, custom_colors,
+    "Deuda Interna TGÑ (1993–2022) — Sin Crisis",
+    "Año", "Millones de dólares",
+    source_text="Fuente: UDAPE"
+)
+add_hitos(ax, df_di.index, hitos_v_sin_crisis, hitos_offset_sin_crisis, line_kwargs={'lw':0.9})
+add_cycle_means_multi(ax, cycles_stats_sin_crisis, medias_offsets_sin_crisis,
+                      abbr_map, custom_colors, line_spacing=ax.get_ylim()[1]*0.03)
+add_year_value_annotations(ax, df_di, annotate_years_sin_crisis, cols_componentes,
+                           annotation_offsets_sin_crisis, custom_colors, arrow_lw=0.5)
+add_period_growth_annotations_multi(ax, df_di, periodos_sin_crisis, cols_componentes,
+                                    tasas_offsets_sin_crisis, custom_colors, abbr_map)
+
+ax.set_ylim(-300, df_di['valor'].max()*1.15)
+plt.savefig(os.path.join(output_dir, "deuda_interna_sin_crisis.png"))
+plt.show()
+plt.close()
+
+# %%
+# ============================================================
+# 3) TERCERA GRÁFICA — PERIODOS ESTRUCTURALES
+# ============================================================
+# Preparación
+annotate_years_periodos = adjust_annot_years(df_di, annot_years_periodos)
+cycles_stats_periodos   = {n: df_di.loc[s, cols_componentes].mean().to_dict()
+                           for n, s in adjust_cycles(df_di, CYCLES_PERIODOS).items()}
+periodos_periodos       = adjust_periods(df_di, periodos_tasas_periodos)
+
+# Offsets
+annotation_offsets_periodos = {
+    'valor': {
+        1993: (-1.5, 1),
+        2006: (0, 1),
+        2022: (0, 1),
+    }
+}
+hitos_offset_periodos       = {a: 0.8 for a in hitos_v_periodos}
+medias_offsets_periodos     = {
+    'Neoliberalismo 93-05':    (1993, 1),
+    'Neodesarrollismo 06-22':  (2006, 1),
+}
+# Tasas y participación específicas del resumen
+
+tasas_offsets_periodos = {
+    '1993-2005': (1995, 0.83),
+    '2006-2022': (2014, 0.65),
+}
+# Gráfica
+fig, ax = init_base_plot(
+    df_di, componentes, custom_colors,
+    "Deuda Interna TGÑ (1993–2022) — Periodos Económicos",
+    "Año", "Millones de dólares",
+    source_text="Fuente: UDAPE"
+)
+add_hitos(ax, df_di.index, hitos_v_periodos, hitos_offset_periodos,
+          annotate_labels=tuple(), line_kwargs={'lw':1.0})
+add_cycle_means_multi(ax, cycles_stats_periodos, medias_offsets_periodos,
+                      abbr_map, custom_colors, line_spacing=ax.get_ylim()[1]*0.03)
+add_year_value_annotations(ax, df_di, annotate_years_periodos, cols_componentes,
+                           annotation_offsets_periodos, custom_colors, arrow_lw=0.5)
+add_period_growth_annotations_multi(ax, df_di, periodos_periodos, cols_componentes,
+                                    tasas_offsets_periodos, custom_colors, abbr_map)
+plt.savefig(os.path.join(output_dir, "deuda_interna_periodos.png"))
+plt.show()
+plt.close()
+
diff --git a/scripts/tesis/serie_completa/importaciones/importaciones.py b/scripts/tesis/serie_completa/importaciones/importaciones.py
index 5c93fee..f53cbee 100644
--- a/scripts/tesis/serie_completa/importaciones/importaciones.py
+++ b/scripts/tesis/serie_completa/importaciones/importaciones.py
@@ -14,193 +14,409 @@
 # ---
 
 # %%
-# ──────────────────────────── IMPORTS ──────────────────────────────
+# ─────────────────────────────────────────────────────────────────────
+# Importaciones
+# ─────────────────────────────────────────────────────────────────────
 import sys, os, sqlite3
 import numpy as np
 import pandas as pd
 import matplotlib.pyplot as plt
-sys.path.append(os.path.abspath('../'))          # utilidades propias
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi, add_participation_cycle_boxes
-)
-
-# ── 0.  Tramos de ciclo ─────────────────────────────────────────────
-CRISIS_82_85      = slice(1982, 1985)
-EXPANSION_86_99   = slice(1986, 1999)
-CRISIS_00_05      = slice(2000, 2005)
-ACUMULACION_06_13 = slice(2006, 2013)
-RECESION_14_24    = slice(2014, 2024)
-
-periods = {
-    "Expansión 86-99": EXPANSION_86_99,
-    "Crisis 00-05": CRISIS_00_05,
-    "Expansión 06-13": ACUMULACION_06_13,
-    "Recesión 14-24":  RECESION_14_24,
-}
-
-# ── 1. Configuración general ───────────────────────────────────────
+sys.path.append(os.path.abspath('../'))  # utilidades propias
+from graficos_utils import *
+from config import *
+# ─────────────────────────────────────────────────────────────────────
+# Configuración general
+# ─────────────────────────────────────────────────────────────────────
 output_dir = "../../../../assets/tesis/serie_completa/importaciones"
 os.makedirs(output_dir, exist_ok=True)
+set_style()
 
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family': 'serif', 'font.size': 12,
-    'axes.titlesize': 16,   'axes.labelsize': 14,
-    'grid.linestyle': '--', 'lines.linewidth': 2,
-    'figure.dpi': 150,      'savefig.bbox': 'tight'
-})
-
-# ── 2. Carga de datos (valores absolutos) ───────────────────────────
+# Carga de datos
 with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
     df = (pd.read_sql('SELECT * FROM composicion_importaciones_uso_destino', conn)
             .set_index('año')
             .sort_index())
     df.rename(columns={'total_valor_oficial_cif': 'importaciones'}, inplace=True)
 
-component_cols = [
-    'bienes_consumo',
-    'materias_primas_productos_intermedios',
-    'bienes_capital',
-    'importaciones'
+# Componentes y columnas
+componentes = [
+    ('bienes_consumo', 'Bienes de consumo'),
+    ('materias_primas_productos_intermedios', 'Materias primas / prod. intermedios'),
+    ('bienes_capital', 'Bienes de capital'),
+    ('importaciones', 'Importaciones (total)'),
 ]
+cols_componentes = [col for col, _ in componentes]
 
-# ── 3. Estadísticas por ciclo ───────────────────────────────────────
-cycle_stats = {
-    name: df.loc[period, component_cols].mean().to_dict()
-    for name, period in periods.items()
+# Abreviaturas
+abbr_map = {
+    'bienes_consumo': 'BC',
+    'materias_primas_productos_intermedios': 'MPPI',
+    'bienes_capital': 'BK',
+    'importaciones': 'Imp.'
 }
 
-# ── 4. Hitos y offsets ──────────────────────────────────────────────
-hitos_v      = {1982:"Crisis", 1986:"Expansión", 2000:"Crisis",
-                2006:"Expansión", 2014:"Recesión"}
-hitos_offset = {a:0.8 for a in hitos_v}
+# ─────────────────────────────────────────────────────────────────────
+# Preparación
+# ─────────────────────────────────────────────────────────────────────
+annotate_years    = adjust_annot_years(df, annot_years)
+CYCLES            = adjust_cycles(df, CYCLES)
+cycle_stats       = {name: df.loc[period, cols_componentes].mean().to_dict()
+                     for name, period in CYCLES.items()}
+periodos          = adjust_periods(df, periodos_tasas)
+custom_colors     = {
+    'bienes_consumo': '#1f77b4',
+    'materias_primas_productos_intermedios': '#ff7f0e',
+    'bienes_capital': '#2ca02c',
+    'importaciones': 'red',
+}
 
+# ─────────────────────────────────────────────────────────────────────
+# Offsets
+# ─────────────────────────────────────────────────────────────────────
+annotation_offsets = {
+    'bienes_consumo': {
+        1982: (0, -800), 1986: (0, -800), 2000: (0, -850),
+        2006: (0, -700), 2014: (0, -450), 2024: (0, -850),
+    },
+    'materias_primas_productos_intermedios': {
+        1982: (0, 600), 1986: (0, 600), 2000: (0, 350),
+        2006: (0, 600), 2014: (0, 300), 2024: (0, -380),
+    },
+    'bienes_capital': {
+        1982: (0, -400), 1986: (0, -500), 2000: (0, -600),
+        2006: (0, -700), 2014: (0, 280), 2024: (0, -400),
+    },
+    'importaciones': {
+        1982: (0, 800), 1986: (0, 600), 2000: (0, 300),
+        2006: (0, 800), 2014: (0, 500), 2024: (0, -300),
+    },
+}
+hitos_offset = {a: 0.8 for a in hitos_v}
 medias_offset = {
-    "Expansión 86-99": (1988, 1),
-    "Crisis 00-05": (2000, 1),
-    "Expansión 06-13": (2006, 1),
-    "Recesión 14-24":  (2016, 1),
+    'Expansión 86-99': (1988, 1),
+    'Crisis 00-05': (2000, 1),
+    'Expansión 06-13': (2006, 1),
+    'Recesión 14-24': (2016, 1),
+}
+tasas_offsets = {
+    '1986-2000': (1988, 0.83),
+    '2000-2006': (2000, 0.83),
+    '2006-2014': (2006, 0.83),
+    '2014-2024': (2016, 0.63),
+}
+participacion_offsets = {
+    '1986-2000': (1988, 0.65),
+    '2000-2006': (2000, 0.65),
+    '2006-2014': (2006, 0.65),
+    '2014-2024': (2016, 0.1),
 }
 
-anot_years = [1982, 1986, 2000, 2006, 2014, 2024]
-annotation_offsets = {
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Importaciones por Uso y Destino, valores CIF (1980–2024)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: Elaboración propia con datos del INE"
+)
+
+add_hitos(
+    ax, df.index, hitos_v, hitos_offset,
+    line_kwargs={'linewidth': 0.9}
+)
+y_max = ax.get_ylim()[1]
+line_spacing = y_max * 0.03
+add_cycle_means_multi(
+    ax, cycle_stats, medias_offset,
+    abbr_map, custom_colors,
+    line_spacing
+)
+
+add_year_value_annotations(
+    ax, df, annotate_years,
+    cols_componentes, annotation_offsets,
+    custom_colors, arrow_lw=0.5
+)
+
+add_period_growth_annotations_multi(
+    ax, df, periodos,
+    cols_componentes, tasas_offsets,
+    custom_colors, abbr_map
+)
+
+add_participation_cycle_boxes(
+    ax, df, periodos,
+    ['bienes_consumo', 'materias_primas_productos_intermedios', 'bienes_capital'],
+    'importaciones', participacion_offsets,
+    abbr_map=abbr_map, colors=custom_colors
+)
+
+ax.set_ylim(-850, df[cols_componentes].max().max() * 1.15)
+
+plt.savefig(os.path.join(output_dir, "importaciones_uso_destino_valores.png"))
+plt.show()
+
+
+# %%
+# ─────────────────────────────────────────────────────────────────────
+# Preparación “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+# 1) Años para anotaciones sin crisis
+annotate_years_sin_crisis = adjust_annot_years(df, annot_years_sin_crisis)
+
+# 2) Ciclos sin crisis
+CYCLES_SC                = adjust_cycles(df, CYCLES_SIN_CRISIS)
+cycles_stats_sin_crisis  = {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES_SC.items()
+}
+
+# 3) Periodos para tasas sin crisis
+periodos_sin_crisis      = adjust_periods(df, periodos_tasas_sin_crisis)
+
+
+# ─────────────────────────────────────────────────────────────────────
+# Offsets “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+# Desplazamientos (dx, dy) para anotaciones año-valor
+annotation_offsets_sin_crisis = {
     'bienes_consumo': {
-        1982: (0, -800),
-        1986: (0, -800),
-        2000: (0, -850),
-        2006: (0, -700),
-        2014: (0, -450),
-        2024: (0, -850),
+        1950: (0, -800),
+        1971: (0, -800),
+        1985: (0, -800),
+        2005: (0, -700),
+        2015: (0, -450),
+        2022: (0, -850),
     },
     'materias_primas_productos_intermedios': {
-        1982: (0,  600),
-        1986: (0,  600),
-        2000: (0,  350),
-        2006: (0,  600),
-        2014: (0,  300),
-        2024: (0,  -380),
+        1950: (0, 600),
+        1971: (0, 600),
+        1985: (0, 600),
+        2005: (0, 600),
+        2015: (0, 300),
+        2022: (0, -380),
     },
     'bienes_capital': {
-        1982: (0, -400),
-        1986: (0, -500),
-        2000: (0, -600),
-        2006: (0, -700),
-        2014: (0, 280),
-        2024: (0, -400),
+        1950: (0, -400),
+        1971: (0, -500),
+        1985: (0, -500),
+        2005: (0, -700),
+        2015: (0, 280),
+        2022: (0, -400),
     },
     'importaciones': {
-        1982: (0,  800),
-        1986: (0, 600),
-        2000: (0, 300),
-        2006: (0, 800),
-        2014: (0, 500),
-        2024: (0, -300),
+        1950: (0, 800),
+        1971: (0, 600),
+        1985: (0, 600),
+        2005: (0, 800),
+        2015: (0, 500),
+        2022: (0, -300),
     },
 }
 
+# Offset para hitos verticales (altura relativa)
+hitos_offset_sin_crisis = {year: 0.8 for year in hitos_v_sin_crisis}
 
-annotation_tasas_offsets = {
-    "1986-2006": (1988, 0.83),
-    "2000-2005": (2000, 0.83),
-    "2006-2014": (2006, 0.83),
-    "2014-2024": (2016, 0.63),
+# Posiciones para medias por ciclo (x = año de inicio, y = proporción eje Y)
+medias_offsets_sin_crisis = {
+    'Expansión 50-70': (1950, 1),
+    'Recesión 71-84':  (1971, 1),
+    'Expansión 85-05': (1985, 1),
+    'Expansión 06-14': (2006, 1),
+    'Recesión 15-24':  (2015, 1),
 }
-participation_offsets = {
-    "1986-2006": (1988, 0.65),
-    "2000-2005": (2000, 0.65),
-    "2006-2014": (2006, 0.65),
-    "2014-2024": (2016, 0.1),
+
+# Posiciones para etiquetas de tasas de crecimiento
+# Claves = f"{start}-{end}" de periodos_tasas_sin_crisis
+tasas_offsets_sin_crisis = {
+    '1950-1970': (1952, 0.83),
+    '1971-1984': (1973, 0.83),
+    '1985-2005': (1988, 0.83),
+    '2006-2014': (2008, 0.83),
+    '2015-2022': (2017, 0.63),
 }
-# ── 5. Gráfico ──────────────────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15, 8))
 
-color_map = {
-    'bienes_consumo': '#1f77b4',
-    'materias_primas_productos_intermedios': '#ff7f0e',
-    'bienes_capital': '#2ca02c',
-    'importaciones': 'red',
+# Posiciones para cajas de participación promedio por ciclo
+# Claves = f"{start}-{end}" de periodos_tasas_sin_crisis
+participation_offsets_sin_crisis = {
+    '1950-1970': (1952, 0.65),
+    '1971-1984': (1973, 0.65),
+    '1985-2005': (1988, 0.65),
+    '2006-2014': (2008, 0.65),
+    '2015-2022': (2017, 0.10),
 }
-labels_map = {
-    'bienes_consumo': 'Bienes de consumo',
-    'materias_primas_productos_intermedios': 'Materias primas / prod. intermedios',
-    'bienes_capital': 'Bienes de capital',
-    'importaciones': 'Importaciones (total)',
-}   
-
-for col in component_cols:
-    ax.plot(df.index, df[col], label=labels_map[col], color=color_map[col])
-
-# ── 6. Hitos ────────────────────────────────────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset, line_kwargs={'linewidth':0.9})
-
-# ── 7. Anotaciones de medias, valores y tasas ───────────────────────
-abbr_map = {'bienes_consumo':'BC', 'materias_primas_productos_intermedios':'MPPI',
-            'bienes_capital':'BK', 'importaciones':'Imp.'}
-component_colors = color_map
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03
 
-add_cycle_means_multi(ax, cycle_stats, medias_offset,
-                      abbr_map, component_colors, line_spacing)
 
-add_year_value_annotations(ax, df, anot_years,
-                           component_cols, annotation_offsets,
-                           component_colors, arrow_lw=0.5)
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica “sin crisis”
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Título – Sin crisis (1980–2024)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: Elaboración propia con datos del INE"
+)
+
+add_hitos(
+    ax, df.index, hitos_v_sin_crisis, hitos_offset_sin_crisis,
+    line_kwargs={'linewidth': 0.9}
+)
 
-# ── 7.1  Copia segura para tasas (evita división por cero) ──────────
-df_g = df.replace(0, np.nan)   # evita OverflowError
+add_year_value_annotations(
+    ax,
+    df,
+    annotate_years_sin_crisis,
+    cols_componentes,
+    annotation_offsets_sin_crisis,
+    custom_colors,
+    arrow_lw=0.5
+)
 
-periodos = [(1986, 2006), (2000, 2005), (2006, 2014), (2014, 2024)]
-add_period_growth_annotations_multi(ax, df_g, periodos,
-    component_cols, annotation_tasas_offsets,
-    component_colors, abbr_map)
+add_period_growth_annotations_multi(
+    ax,
+    df,
+    periodos_sin_crisis,
+    cols_componentes,
+    tasas_offsets_sin_crisis,
+    custom_colors,
+    abbr_map
+)
 
 add_participation_cycle_boxes(
     ax,
     df,
-    periodos,
-    ['bienes_consumo', 'materias_primas_productos_intermedios', 'bienes_capital'],              
-    'importaciones',     
-    participation_offsets,
+    periodos_sin_crisis,
+    ['bienes_consumo', 'materias_primas_productos_intermedios', 'bienes_capital'],
+    'importaciones',
+    participation_offsets_sin_crisis,
     abbr_map=abbr_map,
-    colors=component_colors
+    colors=custom_colors
 )
 
-    
+plt.savefig(os.path.join(output_dir, "importaciones_sin_crisis.png"))
+plt.show()
 
-# ── 8. Ajustes finales ──────────────────────────────────────────────
-ax.set_title("Importaciones por Uso y Destino, valores CIF (1980–2024)",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de dólares")
-ax.set_xticks(df.index[::max(1, len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', fontsize=12, ncol=2)
 
-ax.set_ylim(-850, df[component_cols].max().max()*1.15)
+# %%
+# ─────────────────────────────────────────────────────────────────────
+# Preparación
+# ─────────────────────────────────────────────────────────────────────
+# 1) Años anotados
+annotate_years_periodos = adjust_annot_years(df, annot_years_periodos)
 
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "importaciones_uso_destino_valores.png"))
-plt.show()
+# 2) Ciclos → ahora usamos los “periodos” estructurales
+CYCLES_PERIODOS     = adjust_cycles(df, CYCLES_PERIODOS)
+cycle_stats_periodos  = {nom: df.loc[sli, cols_componentes].mean().to_dict()
+                for nom, sli in CYCLES_PERIODOS.items()}
+
+# 3) Periodos para tasas
+periodos_periodos = adjust_periods(df, periodos_tasas_periodos)
+
+# ─────────────────────────────────────────────────────────────────────
+# Offsets (ejemplo de punto de partida)
+# ─────────────────────────────────────────────────────────────────────
+# se reutilizan muchos offsets, pero ajustamos la clave según año-rango
+annotation_offsets_periodos = {
+    'bienes_consumo': {
+        1950: (0, -800), 1985: (0, -800), 2006: (0, -700),
+        2024: (0, -850),
+    },
+    'materias_primas_productos_intermedios': {
+        1950: (0, 600), 1985: (0, 600), 2006: (0, 600),
+        2024: (0, -380),
+    },
+    'bienes_capital': {
+        1950: (0, -400), 1985: (0, -600), 2006: (0, -700),
+        2024: (0, -400),
+    },
+    'importaciones': {
+        1950: (0, 800), 1985: (0, 600), 2006: (0, 800),
+        2024: (0, -300),
+    },
+}
+
+# líneas verticales por periodo
+hitos_offset_periodos = {a: 0.8 for a in hitos_v_periodos}
+
+# Medias por ciclo (texto) → coordenadas x,y (proporción de eje Y)
+medias_offsets_periodos = {
+    'Intervensionismo-estatal 50-84': (1952, 1),
+    'Neoliberalismo 85-05':           (1990, 1),
+    'Neodesarrollismo 06-24':         (2010, 1),
+}
+
+# Tasas de crecimiento: posición de cada bloque
+tasas_offsets_periodos = {
+    '1980-1984': (1980, 0.83),
+    '1985-2005': (1988, 0.83),
+    '2006-2024': (2008, 0.63),
+}
+
+# Participación promedio dentro de cada periodo
+participation_offsets_periodos = {
+    '1980-1984': (1980, 0.65),
+    '1985-2005': (1988, 0.65),
+    '2006-2024': (2008, 0.10),
+}
+
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df,
+    componentes,
+    custom_colors,
+    "Importaciones por Uso y Destino – Enfoque por Periodo Económico (1950–2024)",
+    "Año",
+    "Millones de dólares",
+    source_text="Fuente: Elaboración propia con datos del INE"
+)
 
+# Hitos verticales (solo muestra etiquetas de años–periodo)
+add_hitos(
+    ax, df.index, hitos_v_periodos, hitos_offset_periodos,
+    annotate_labels=tuple(),                     # no resaltamos “Crisis”, solo etiquetas simples
+    line_kwargs={'linewidth': 1.0}
+)
+
+# Medias por periodo
+y_max = ax.get_ylim()[1]
+add_cycle_means_multi(
+    ax, cycle_stats_periodos, medias_offsets_periodos,
+    abbr_map, custom_colors,
+    line_spacing=y_max * 0.03
+)
+
+# Valores puntuales (años clave)
+add_year_value_annotations(
+    ax, df, annotate_years_periodos,
+    cols_componentes, annotation_offsets_periodos,
+    custom_colors, arrow_lw=0.5
+)
+
+# Tasas de crecimiento por periodo
+add_period_growth_annotations_multi(
+    ax, df, periodos_periodos,
+    cols_componentes, tasas_offsets_periodos,
+    custom_colors, abbr_map
+)
+
+# Participación porcentual media por periodo
+add_participation_cycle_boxes(
+    ax, df, periodos_periodos,
+    ['bienes_consumo', 'materias_primas_productos_intermedios', 'bienes_capital'],
+    'importaciones', participation_offsets_periodos,
+    abbr_map=abbr_map, colors=custom_colors
+)
+
+# Ajuste final de ejes y guardado
+ax.set_ylim(-850, df[cols_componentes].max().max() * 1.15)
+plt.savefig(os.path.join(output_dir, "importaciones_periodos_valores.png"))
+plt.show()
diff --git a/scripts/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py b/scripts/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py
index 9b07b7b..ccacca0 100644
--- a/scripts/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py
+++ b/scripts/tesis/serie_completa/pib/participacion_pib_rama_de_actividad.py
@@ -17,7 +17,10 @@
 import pandas as pd
 import matplotlib.pyplot as plt
 import sqlite3, os
-import numpy as np
+import numpy as np 
+
+sys.path.append(os.path.abspath('../'))
+from config import *
 # ── 1. Parámetros y rutas ────────────────────────────────────────────────────
 CRISIS_52_55     = slice(1952, 1955)   # Crisis
 EXPANSION_56_69  = slice(1956, 1969)   # Expansión
@@ -133,6 +136,79 @@ for yr, lbl in hitos_v.items():
             bbox=dict(facecolor="white", alpha=0.85, edgecolor="none"),
             zorder=6
         )
+MEAN_OFFSETS = {
+    CRISIS_52_55:      {'consumo_publico': (0.0, 12.0)},
+    EXPANSION_56_69:   {'consumo_publico': (0.0, 14.5)},
+    RECESION_70_81:    {'consumo_publico': (0.0, 14.5)},
+    CRISIS_82_85:      {'consumo_publico': (0.0, 12.0)},
+    EXPANSION_86_99:   {'consumo_publico': (0.0, 15.0)},
+    CRISIS_00_05:      {'consumo_publico': (0.0, 12.0)},
+    ACUMULACION_06_13: {'consumo_publico': (0.0, 12.0)},
+    RECESION_14_23:    {'consumo_publico': (0.0, 12.0)},
+}
+
+
+# 2️⃣  Componentes cuyos promedios NO quieres anotar
+SKIP_MEANS = {
+    CRISIS_52_55:      {'energia'},
+    EXPANSION_56_69:   {'energia'},
+    RECESION_70_81:    {'energia'},
+    CRISIS_82_85:      {'energia'},
+    EXPANSION_86_99:   {'energia'},
+    CRISIS_00_05:      {'energia'},
+    ACUMULACION_06_13: {'energia'},
+    RECESION_14_23:    {'energia'},
+}
+
+def annotate_cycle_means(
+    ax, data, cycle_slice, cols,
+    offsets=None, skip=None,
+    fmt="{val:.0f}", **text_kw
+):
+    sub = data.loc[cycle_slice, cols]
+    if sub.empty:
+        return
+
+    means = sub.mean()
+    start_idx = data.index.get_loc(sub.index[0])
+    end_idx   = data.index.get_loc(sub.index[-1])
+    x_mid     = (start_idx + end_idx) / 2
+
+    cum = 0
+    for col in cols:
+        # omitir si el usuario lo indica
+        if skip and col in skip.get(cycle_slice, set()):
+            cum += means[col]
+            continue
+
+        val = means[col]
+        dx, dy = (0, 0)
+        if offsets:
+            dx, dy = offsets.get(cycle_slice, {}).get(col, (0, 0))
+
+        ax.text(
+            x_mid + dx,
+            cum + val/2 + dy,
+            fmt.format(val=val),
+            ha="center", va="center",
+            zorder=6,
+            **text_kw
+        )
+        cum += val
+# ── 5.2 Medias por ciclo ─────────────────────────────────────────────
+# ── 5.2 Medias por ciclo (con offsets y skips) ────────────────────────────
+cycles = [
+    CRISIS_52_55, EXPANSION_56_69, RECESION_70_81, CRISIS_82_85,
+    EXPANSION_86_99, CRISIS_00_05, ACUMULACION_06_13, RECESION_14_23,
+]
+for ciclo in cycles:
+    annotate_cycle_means(
+        ax, pct, ciclo, cols,
+        offsets=MEAN_OFFSETS,
+        skip=SKIP_MEANS,
+        fontsize=13, color="black", fontweight="bold"
+    )
+
 
 # ── 6. Guardar y mostrar ────────────────────────────────────────────────────
 plt.tight_layout()
diff --git a/scripts/tesis/serie_completa/pib/pib_por_ramas.py b/scripts/tesis/serie_completa/pib/pib_por_ramas.py
index 8f42343..097abc6 100644
--- a/scripts/tesis/serie_completa/pib/pib_por_ramas.py
+++ b/scripts/tesis/serie_completa/pib/pib_por_ramas.py
@@ -14,275 +14,165 @@
 # ---
 
 # %%
+# ── Imports ──────────────────────────────────────────────────────────
 import pandas as pd
 import matplotlib.pyplot as plt
 import sqlite3, os, sys
 sys.path.append(os.path.abspath('../'))
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi
-)
-
+from graficos_utils import *
+from config import *
 
-
-EXPANSION_50_70   = slice(1950, 1970)   # Expansión
-RECESION_71_84    = slice(1971, 1984)   # Recesión
-EXPANSION_85_05   = slice(1985, 2005)   # Expansión
-ACUMULACION_05_14 = slice(2005, 2014)   # Acumulación (expansión)
-RECESION_15_23    = slice(2015, 2023)   # Recesión
-# ── 1. Configuración general ─────────────────────────────────────────
+# ── Configuración general ────────────────────────────────────────────
+# Dirección
 output_dir = "../../../../assets/tesis/serie_completa/pib"
 os.makedirs(output_dir, exist_ok=True)
 
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family':'serif', 'font.size':12,
-    'axes.titlesize':16,   'axes.labelsize':14,
-    'grid.linestyle':'--', 'lines.linewidth':2,
-    'figure.dpi':150,      'savefig.bbox':'tight'
-})
+# Estilos
+set_style()
 
-# ── 2. Carga de datos ────────────────────────────────────────────────
+# Carga de datos
 with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
     df = (pd.read_sql('SELECT * FROM pib_ramas', conn, index_col='año')
-            .sort_index()) / 1000        # miles  → millones
+            .sort_index()) / 1000        # miles → millones
 
-sectores = [
+# Sectores y columnas
+componentes = [
     ("agropecuario",      "Agropecuario"),
     ("mineria",           "Minería"),
     ("petroleo",          "Petróleo"),
     ("comercio_finanzas", "Comercio-Finanzas"),
 ]
-cols_sectores = [col for col, _ in sectores]
-#estadisticas
-avg_expansion_50_70 = df.loc[EXPANSION_50_70, cols_sectores].mean().to_dict()
-avg_recesion_71_84  = df.loc[RECESION_71_84, cols_sectores].mean().to_dict()
-avg_expansion_85_05 = df.loc[EXPANSION_85_05, cols_sectores].mean().to_dict()
-avg_expansion_05_14 = df.loc[ACUMULACION_05_14, cols_sectores].mean().to_dict()
-avg_recesion_15_23  = df.loc[RECESION_15_23, cols_sectores].mean().to_dict()
-
-# ── 4. Hitos, años clave, offsets ────────────────────────────────────
-hitos_v = {
-    1950: "Expansion",
-    1971: "Recesion",
-    1985: "Expansion",
-    2005: "Expansion",
-    2015: "Recesion"
+cols_componentes = [col for col, _ in componentes]
+
+# Abreviaturas
+abbr = {
+    "agropecuario":      "Ag",
+    "mineria":           "Mi",
+    "petroleo":          "Pe",
+    "comercio_finanzas": "CF",
 }
 
-anot_years = [1950,1971,1985, 2005, 2015,2022]
+# ── Preparación ──────────────────────────────────────────────────────
+annot_years=adjust_annot_years(df,annot_years_sin_crisis)
+# Ciclos y estadísticas
+CYCLES_SIN_CRISIS = adjust_cycles(df, CYCLES_SIN_CRISIS)
+cycle_stats_sin_crisis = {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES_SIN_CRISIS.items()
+}
+periodos_sin_crisis=adjust_periods(df,periodos_tasas_sin_crisis)
+# Colores personalizados
+custom_colors = {
+    "agropecuario":      "#1f77b4",  # blue
+    "mineria":           "#ff7f0e",  # orange
+    "petroleo":          "#2ca02c",  # green
+    "comercio_finanzas": "#8c564b",  # café
+}
 
-# añade (dx,dy) solo si quieres mover textos manualmente
+# ── Offsets ──────────────────────────────────────────────────────────
 annotation_offsets = {
     "agropecuario": {
         1950: (0, 300), 1971: (0, 300), 1985: (-1.5, -450),
-        2005: (0, -300), 2015: (-0.5, 370),2022:(0,200)
+        2005: (0, -300), 2015: (-0.5, 370), 2022: (0, -500)
     },
     "mineria": {
         1950: (0, 200), 1971: (-0.3, 400), 1985: (0, -320),
-        2005: (0, -250), 2015: (0, -350),2022:(0,-400)
+        2005: (0, -250), 2015: (0, -350), 2022: (0, -400)
     },
     "petroleo": {
-        1950: (0, -200), 1971: (0, -300),1985: (0.3, 300),
-        2005: (0, 270),
-        2015: (0, 220),
-        2022:(0,200)
+        1950: (0, -200), 1971: (0, -300), 1985: (0.3, 300),
+        2005: (0, 270), 2015: (0, 220), 2022: (0, 200)
     },
     "comercio_finanzas": {
         1950: (0, -250), 1971: (0.8, -400), 1985: (1.5, 500),
-        2005: (0, 300),
-        2015: (2.6, 300),
-        2022:(0,200)
+        2005: (0, 300), 2015: (-0.7, 600), 2022: (0, 200)
     },
 }
-# hitos_offset: año → fracción de eje Y (0–1) donde apoya la base del recuadro
-hitos_offset = {
-    1950: 0.45, 1971: 0.50, 1985: 0.50,
-    2005: 0.62, 2015: 0.48
-}
-annotation_tasas_offsets = {
-    'agropecuario': {
-        1970: (0,   9000),   # desplaza la etiqueta 1956→1970
-        1986: (-2.3,  8900),   # desplaza la etiqueta 1970→1986
-        2006: (-3.5,   800),   # desplaza la etiqueta 1986→2006
-        2014: (-0.9,  -4600),   # desplaza la etiqueta 2006→2014
-        2022: (1,-5200)
-    }
-}
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-custom_colors = {
-    "agropecuario":      "#1f77b4",  # blue
-    "mineria":           "#ff7f0e",  # orange
-    "petroleo":          "#2ca02c",  # green
-    "comercio_finanzas": "#8c564b",  # café
-}
-
-fig, ax = plt.subplots(figsize=(13,8))
-for col, label in sectores:
-    ax.plot(df.index, df[col],
-            label=label,
-            color=custom_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-for yr, lbl in hitos_v.items():
-    if yr in df.index:
-        ax.axvline(x=yr, color='gray', linestyle='--', linewidth=1, zorder=5)
-        y_max = ax.get_ylim()[1]
-        offset = hitos_offset.get(yr, 0.82)   # fallback si falta
-        if lbl=='Crisis':
-            ax.text(yr, y_max * offset, lbl,
-                    rotation=90, ha='right', va='top',
-                    fontsize=14, color='gray',
-                    bbox=dict(facecolor='#f0f0f0', alpha=0.6, edgecolor='none'),
-                    zorder=6)
-
-# ── 7. Anotaciones de valores ────────────────────────────────────────
-for yr in anot_years:
-    if yr not in df.index:
-        continue
-    vals = [(df.loc[yr, col], col) for col, _ in sectores]
-    vals.sort(key=lambda t: t[0])  # de menor a mayor
-    for y, col in vals:
-        dx, dy = annotation_offsets.get(col, {}).get(yr, (0, 0))
-        ax.annotate(f"{y:,.0f}",
-                    xy=(yr, y), xytext=(yr + dx, y + dy),
-                    ha='center', va='center',
-                    fontsize=14, color=custom_colors[col],
-                    arrowprops=dict(arrowstyle='-',
-                                    color=custom_colors[col], lw=1))
-        
-# Mapa de tasas por año final
-periodos = [
-    (1971, 1984),
-    (1985, 2005),
-    (2005, 2014),
-    (2015,2022)
-]
-componentes = ["agropecuario", "mineria", "comercio_finanzas", "petroleo"]
 
+hitos_offset = {1950: 0.45, 1971: 0.50, 1985: 0.50, 2005: 0.62, 2015: 0.48}
 
+medias_offsets = {
+    "Expansión 50-70": (1958, 0.90),
+    "Recesión 71-84":  (1972, 0.90),
+    "Expansión 85-05": (1988, 0.90),
+    "Expansión 06-14": (2005.1, 0.99),
+    "Recesión 15-22":  (2016.4, 0.85),
+}
 
-#cuadro de estadisticas
-# 8.1 Abreviaturas para las ramas
-abbr = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "petroleo":          "Pe",
-    "comercio_finanzas": "CF",
+period_offsets = {
+    "1950-1970": (1958, 0.73),
+    "1971-1984": (1972, 0.73),
+    "1985-2005": (1988, 0.73),
+    "2006-2014": (2005.1, 0.83),
+    "2015-2022": (2016.4, 0.52),
 }
 
-# 8.2 Estadísticas promedio por ciclo (ya calculadas arriba)
-cycle_stats = {
-    "Expansión 50-70": avg_expansion_50_70,
-    "Recesión 71-84":  avg_recesion_71_84,
-    "Expansión 85-05": avg_expansion_85_05,
-    "Expansión 05-14": avg_expansion_05_14,
-    "Recesión 15-22":  avg_recesion_15_23,
+participation_offsets = {
+    "1950-1970": (1958, 0.56),
+    "1971-1984": (1972, 0.56),
+    "1985-2005": (1988, 0.56),
+    "2006-2014": (2005.1, 0.675),
+    "2015-2022": (2016, 0.14),
 }
 
-# 8.3 Colores de cada rama (mismo diccionario de la línea)
-component_colors = custom_colors
+# ── Gráfica ──────────────────────────────────────────────────────────
+fig, ax=init_base_plot(
+    df=df,
+    series=componentes,
+    colors=custom_colors,
+    title=f"PIB por principales Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
+    xlabel="Año",
+    ylabel="Millones de bolivianos · 1990",
+    source_text="Fuente: Elaboración propia con datos de UDAPE"
+)
 
-text_offsets = {
-    "Expansión 50-70": (1958,  0.90),
-    "Recesión 71-84":  (1972,  0.90),
-    "Expansión 85-05": (1988,  0.90),
-    "Expansión 05-14": (2005.8,  0.98),
-    "Recesión 15-22": (2016.4,  0.53),
-}
-# calcula y_max DESPUÉS de haber dibujado las series
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03          # 3 % de la altura
+# Hitos verticales
+add_hitos(ax, df.index, hitos_v_sin_crisis, hitos_offset)
+
+# Anotaciones de valores por año
+add_year_value_annotations(
+    ax, df, annot_years,
+    cols_componentes, annotation_offsets, custom_colors
+)
 
+# Cuadros de medias por ciclo
+y_max = ax.get_ylim()[1]
+line_spacing = y_max * 0.03
 add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr,
-    component_colors,
-    line_spacing=line_spacing,        # ← pasa el valor correcto
+    ax, cycle_stats_sin_crisis, medias_offsets,
+    abbr, custom_colors, line_spacing
 )
 
 
-# 2. Parámetros de posición y estilo (sobre tu ax ya dibujado)
-y_max       = ax.get_ylim()[1]
-line_space  = y_max * 0.03
-# abreviaturas para cada componente
-abbr_comp   = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "comercio_finanzas": "CF",
-    "petroleo":          "Pe",
-}
-# 3. Coordenadas aproximadas para cada periodo
-period_offsets = {
-    "1971-1984": (1972,  0.60),
-    "1985-2005": (1988,  0.60),
-    "2005-2014": (2005.8,  0.82),
-    "2015-2022": (2016.4, 0.14),
-}
 
-# 4. Loop para anotar cada cuadro de tasas
+# Anotaciones de tasas de crecimiento por periodo
 add_period_growth_annotations_multi(
-    ax,df,
-    periodos,
-    [col for col,_ in sectores],
-    period_offsets,
-    component_colors,
-    abbr_comp,
+    ax, df, periodos_sin_crisis, cols_componentes,
+    period_offsets, custom_colors, abbr
 )
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"PIB por Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=3, fontsize=12)
-# ── Pie de fuente ─────────────────────────────────────────────────────────
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
+
+# Cuadros de participación por ciclo
+add_participation_cycle_boxes(
+    ax, df, periodos_sin_crisis, cols_componentes, "pib_real",
+    participation_offsets, abbr, custom_colors
 )
 
-plt.tight_layout()
 plt.savefig(os.path.join(output_dir, "pib_rama_de_actividad_1.png"))
 plt.show()
 
-# %%
-PERIODO_1 = slice(1950, 1984)   # Crisis
-PERIODO_2 = slice(1985, 2005)   # Expansión
-PERIODO_3 = slice(2006, 2022)   # Recesión
-
 
-
-sectores = [
-    ("agropecuario",      "Agropecuario"),
-    ("mineria",           "Minería"),
-    ("petroleo",          "Petróleo"),
-    ("comercio_finanzas", "Comercio-Finanzas"),
-]
-cols_sectores = [col for col, _ in sectores]
-#estadisticas
-avg_periodo_1 = df.loc[PERIODO_1, cols_sectores].mean().to_dict()
-avg_periodo_2  = df.loc[PERIODO_2, cols_sectores].mean().to_dict()
-avg_periodo_3 = df.loc[PERIODO_3, cols_sectores].mean().to_dict()
-
-
-# ── 4. Hitos, años clave, offsets ────────────────────────────────────
-hitos_v = {
-    1950: "1950-1984",
-    1985: "1985-2005",
-    2006: "2006-2022",
+# %%
+# Estadísticas de ciclos
+annot_years_periodos=adjust_annot_years(df,annot_years_periodos)
+CYCLES_PERIODOS=adjust_cycles(df,CYCLES_PERIODOS)
+cycle_stats_periodos = {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES_PERIODOS.items()
 }
+periodos_periodos=adjust_periods(df,periodos_tasas_periodos)
 
-
-anot_years = [1950,1985,2006,2022]
-
-# añade (dx,dy) solo si quieres mover textos manualmente
+# ── Offsets ──────────────────────────────────────────────────────────
+# Desplazamientos de anotaciones por rama y año
 annotation_offsets = {
     "agropecuario": {
         1950: (0, 300), 1985: (-1.5, -450),
@@ -290,167 +180,191 @@ annotation_offsets = {
     },
     "mineria": {
         1950: (0, 200), 1985: (0, -320),
-        2006: (0, -250), 2022:(0,-400)
+        2006: (0, -750), 2022:(0,-400)
     },
     "petroleo": {
         1950: (0, -200), 1985: (0.3, 300),
-        2006: (0, 270),
+        2006: (-0.8, 270),
         2022:(0,200)
     },
     "comercio_finanzas": {
         1950: (0, -250), 1985: (1.5, 500),
-        2006: (0, 300),
+        2006: (-0.8, 400),
         2022:(0,200)
     },
 }
-period_offsets = {
-    "1950-1984": (1956,  0.60),
-    "1985-2005": (1994,  0.75),
-    "2006-2022": (2006,  0.75),
-}
-text_offsets = {
-    "1950-1984": (1956,  0.90),
-    "1985-2005":  (1994,  0.95),
-    "2006-2022": (2006,  0.95),
 
-}
-# hitos_offset: año → fracción de eje Y (0–1) donde apoya la base del recuadro
+# Hitos verticales
 hitos_offset = {
     1950: 0.45, 1985: 0.50, 2006: 0.50,
 }
-annotation_tasas_offsets = {
-    'agropecuario': {
-        1970: (0,   9000),   # desplaza la etiqueta 1956→1970
-        1986: (-2.3,  8900),   # desplaza la etiqueta 1970→1986
-        2006: (-3.5,   800),   # desplaza la etiqueta 1986→2006
-        2014: (-0.9,  -4600),   # desplaza la etiqueta 2006→2014
-        2022: (1,-5200)
-    }
+
+# Desplazamientos de recuadros de periodo y texto
+period_offsets = {
+    "1950-1984": (1956, 0.73),
+    "1985-2005": (1988, 0.75),
+    "2006-2022": (2006, 0.75),
 }
-# ── 5. Gráfico ───────────────────────────────────────────────────────
-custom_colors = {
-    "agropecuario":      "#1f77b4",  # blue
-    "mineria":           "#ff7f0e",  # orange
-    "petroleo":          "#2ca02c",  # green
-    "comercio_finanzas": "#8c564b",  # café
+medias_offsets = {
+    "Intervensionismo-estatal 50-84": (1956, 0.90),
+    "Neoliberalismo 85-05": (1988, 0.95),
+    "Neodesarrollismo 06-22": (2006, 0.95),
 }
 
-fig, ax = plt.subplots(figsize=(13,8))
-for col, label in sectores:
-    ax.plot(df.index, df[col],
-            label=label,
-            color=custom_colors[col])
-
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-for yr, lbl in hitos_v.items():
-    if yr in df.index:
-        ax.axvline(x=yr, color='gray', linestyle='--', linewidth=1, zorder=5)
-        y_max = ax.get_ylim()[1]
-        offset = hitos_offset.get(yr, 0.82)   # fallback si falta
-        if lbl=='Crisis':
-            ax.text(yr, y_max * offset, lbl,
-                    rotation=90, ha='right', va='top',
-                    fontsize=14, color='gray',
-                    bbox=dict(facecolor='#f0f0f0', alpha=0.6, edgecolor='none'),
-                    zorder=6)
-
-# ── 7. Anotaciones de valores ────────────────────────────────────────
-for yr in anot_years:
-    if yr not in df.index:
-        continue
-    vals = [(df.loc[yr, col], col) for col, _ in sectores]
-    vals.sort(key=lambda t: t[0])  # de menor a mayor
-    for y, col in vals:
-        dx, dy = annotation_offsets.get(col, {}).get(yr, (0, 0))
-        ax.annotate(f"{y:,.0f}",
-                    xy=(yr, y), xytext=(yr + dx, y + dy),
-                    ha='center', va='center',
-                    fontsize=14, color=custom_colors[col],
-                    arrowprops=dict(arrowstyle='-',
-                                    color=custom_colors[col], lw=1))
-        
-# Mapa de tasas por año final
-periodos = [
-    (1985, 2005),
-    (2006, 2022)
-]
-componentes = ["agropecuario", "mineria", "comercio_finanzas", "petroleo"]
+# Desplazamientos de participación por ciclo
+participation_offsets = {
+    "1950-1984": (1956, 0.56),
+    "1985-2005": (1988, 0.56),
+    "2006-2022": (2009.1, 0.15),
+}
 
+#grafica
+fig, ax = init_base_plot(
+    df=df,
+    series=componentes,
+    colors=custom_colors,
+    title=f"PIB por principales Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
+    xlabel="Año",
+    ylabel="Millones de bolivianos · 1990",
+    source_text="Fuente: Elaboración propia con datos de UDAPE"
+)
 
+# Líneas de hitos y anotaciones
+add_hitos(ax, df.index, hitos_v_periodos, hitos_offset)
+add_year_value_annotations(
+    ax, df, annot_years_periodos, cols_componentes,
+    annotation_offsets, custom_colors
+)
 
-#cuadro de estadisticas
-# 8.1 Abreviaturas para las ramas
-abbr = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "petroleo":          "Pe",
-    "comercio_finanzas": "CF",
-}
+add_cycle_means_multi(
+    ax, cycle_stats_periodos, medias_offsets,
+    abbr, custom_colors, line_spacing=line_spacing
+)
+
+# Tasas de crecimiento por periodo
+add_period_growth_annotations_multi(
+    ax, df, periodos_periodos, cols_componentes,
+    period_offsets, custom_colors, abbr
+)
+
+# Cuadros de participación por ciclo
+add_participation_cycle_boxes(
+    ax, df, periodos_periodos, cols_componentes,
+    "pib_real", participation_offsets,
+    abbr, custom_colors
+)
+
+plt.savefig(os.path.join(output_dir, "pib_rama_de_actividad_2.png"))
+plt.show()
 
-# 8.2 Estadísticas promedio por ciclo (ya calculadas arriba)
+
+# %%
+# Estadísticas de ciclos
+annot_years=adjust_annot_years(df,annot_years)
+CYCLES=adjust_cycles(df,CYCLES)
 cycle_stats = {
-    "1950-1984":   avg_periodo_1,
-    "1985-2005":   avg_periodo_2,
-    "2006-2022":   avg_periodo_3,
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES.items()
 }
+periodos=adjust_periods(df,periodos_tasas)
 
-# 8.3 Colores de cada rama (mismo diccionario de la línea)
-component_colors = custom_colors
+# ── Offsets ──────────────────────────────────────────────────────────
+# Desplazamientos de anotaciones por rama y año (anot_years)
+annotation_offsets = {
+    "agropecuario": {
+        1952: (0, 300), 1956: (0, 350), 1970: (-1.5, -450),
+        1982: (0, -300), 1986: (-1.0, 400), 2000: (0, -200),
+        2006: (0, -300), 2014: (1.0, 450), 2023: (0, -500),
+    },
+    "mineria": {
+        1952: (0, 200), 1956: (0, 250), 1970: (0, -320),
+        1982: (0.5, -400), 1986: (0, -350), 2000: (0, -300),
+        2006: (0, -750), 2014: (0.5, 500), 2023: (0, -400),
+    },
+    "petroleo": {
+        1952: (0, -200), 1956: (0.3, -250), 1970: (0.3, 300),
+        1982: (0, -300), 1986: (0.5, 350), 2000: (-0.5, 250),
+        2006: (-0.8, 270), 2014: (0.5, 300), 2023: (0, 200),
+    },
+    "comercio_finanzas": {
+        1952: (0, -250), 1956: (1.5, -300), 1970: (1.5, 500),
+        1982: (0, 300), 1986: (1.0, 550), 2000: (-0.7, 400),
+        2006: (-0.8, 400), 2014: (1.2, 600), 2023: (0, 200),
+    },
+}
 
+# Hitos verticales: fracción de eje Y (0–1) en el inicio de cada ciclo
+hitos_offset = {
+    1952: 0.45, 1956: 0.50, 1970: 0.50,
+    1982: 0.55, 1986: 0.48, 2000: 0.60,
+    2006: 0.62, 2014: 0.50, 2023: 0.48,
+}
 
-# calcula y_max DESPUÉS de haber dibujado las series
-y_max = ax.get_ylim()[1]
-line_spacing = y_max * 0.03          # 3 % de la altura
+# Desplazamientos de recuadros de tasa y texto por periodo
+period_offsets = {
+    "1956-1970": (1963, 0.73),
+    "1970-1982": (1978, 0.75),
+    "1986-2000": (1993, 0.75),
+    "2000-2006": (2003, 0.70),
+    "2006-2014": (2010, 0.83),
+    "2014-2022": (2018, 0.52),
+}
+text_offsets = {
+    "Expansión 56-69": (1963, 0.95),
+    "Recesión 70-81": (1978, 0.95),
+    "Expansión 86-99": (1993, 0.95),
+    "Crisis 00-05": (2003, 0.90),
+    "Expansión 06-13": (2010, 0.99),
+    "Recesión 14-23": (2018, 0.85),
+}
 
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr,
-    component_colors,
-    line_spacing=line_spacing,        # ← pasa el valor correcto
+# Desplazamientos de cuadros de participación por periodo
+participation_offsets = {
+    "1956-1970": (1963, 0.56),
+    "1970-1986": (1978, 0.60),
+    "1986-2000": (1993, 0.60),
+    "2000-2006": (2003, 0.50),
+    "2006-2014": (2010, 0.675),
+    "2014-2022": (2018, 0.14),
+}
+#grafica
+fig, ax = init_base_plot(
+    df=df,
+    series=componentes,
+    colors=custom_colors,
+    title=f"PIB por principales Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
+    xlabel="Año",
+    ylabel="Millones de bolivianos · 1990",
+    source_text="Fuente: Elaboración propia con datos de UDAPE"
 )
 
+# Líneas de hitos y anotaciones
+add_hitos(ax, df.index, hitos_v, hitos_offset)
+add_year_value_annotations(
+    ax, df, annot_years, cols_componentes,
+    annotation_offsets, custom_colors
+)
 
-# 2. Parámetros de posición y estilo (sobre tu ax ya dibujado)
-y_max       = ax.get_ylim()[1]
-line_space  = y_max * 0.03
-# abreviaturas para cada componente
-abbr_comp   = {
-    "agropecuario":      "Ag",
-    "mineria":           "Mi",
-    "comercio_finanzas": "CF",
-    "petroleo":          "Pe",
-}
-# 3. Coordenadas aproximadas para cada periodo
-
+add_cycle_means_multi(
+    ax, cycle_stats, text_offsets,
+    abbr, custom_colors, line_spacing=line_spacing
+)
 
-# 4. Loop para anotar cada cuadro de tasas
+# Tasas de crecimiento por periodo
 add_period_growth_annotations_multi(
-    ax,df,
-    periodos,
-    [col for col,_ in sectores],
-    period_offsets,
-    component_colors,
-    abbr_comp,
+    ax, df, periodos, cols_componentes,
+    period_offsets, custom_colors, abbr
 )
-# ── 8. Ajustes finales ───────────────────────────────────────────────
-ax.set_title(f"PIB por Ramas de Actividad ({df.index[0]}–{df.index[-1]})",
-             fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=3, fontsize=12)
-# ── Pie de fuente ─────────────────────────────────────────────────────────
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
+
+# Cuadros de participación por ciclo
+add_participation_cycle_boxes(
+    ax, df, periodos, cols_componentes,
+    "pib_real", participation_offsets,
+    abbr, custom_colors
 )
 
-plt.tight_layout()
 plt.savefig(os.path.join(output_dir, "pib_rama_de_actividad_2.png"))
 plt.show()
+
+# %%
+print(cycle_stats)
diff --git a/scripts/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py b/scripts/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py
index 3462807..1d8de08 100644
--- a/scripts/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py
+++ b/scripts/tesis/serie_completa/pib/pib_tipo_de_gasto_serie_completa.py
@@ -14,41 +14,36 @@
 # ---
 
 # %%
+# ─────────────────────────────────────────────────────────────────────
+# Importaciones
+# ─────────────────────────────────────────────────────────────────────
 import pandas as pd
 import matplotlib.pyplot as plt
-import sqlite3, os
-import sys
-sys.path.append(os.path.abspath('../'))          # utilidades propias
-from graficos_utils import (
-    add_hitos, add_cycle_means_multi,
-    add_year_value_annotations, add_period_growth_annotations_multi,
-    add_participation_cycle_boxes
-)
-
-EXPANSION_50_70   = slice(1950, 1970)   # Expansión
-RECESION_71_84    = slice(1971, 1984)   # Recesión
-EXPANSION_85_05   = slice(1985, 2005)   # Expansión
-ACUMULACION_06_14 = slice(2005, 2014)   # Acumulación (expansión)
-RECESION_15_23    = slice(2015, 2023)   # Recesión
-
-# ── 1. Configuración general y salida ────────────────────────────────
+import sqlite3, os, sys
+sys.path.append(os.path.abspath('../'))  # utilidades propias
+from graficos_utils import *
+from config import *
+
+# ─────────────────────────────────────────────────────────────────────
+# Configuración general
+# ─────────────────────────────────────────────────────────────────────
+# Dirección de salida
 output_dir = "../../../../assets/tesis/serie_completa/pib"
 os.makedirs(output_dir, exist_ok=True)
-plt.style.use('seaborn-v0_8-whitegrid')
-plt.rcParams.update({
-    'font.family':'serif','font.size':12,
-    'axes.titlesize':16,'axes.labelsize':14,
-    'grid.linestyle':'--','lines.linewidth':2,
-    'figure.dpi':150,'savefig.bbox':'tight'
-})
-component_colors = {
-    'pib_real_base_1990': '#1f77b4'
-}
-# ── 2. Carga de datos ────────────────────────────────────────────────
+
+# Estilo global de las gráficas
+set_style()
+
+# ─────────────────────────────────────────────────────────────────────
+# Carga de datos
+# ─────────────────────────────────────────────────────────────────────
 with sqlite3.connect('../../../../db/proyectomacro.db') as conn:
-    df = pd.read_sql("SELECT * FROM pib_real_gasto", conn, index_col='año') / 1000
+    df = (pd.read_sql("SELECT * FROM pib_real_gasto", conn, index_col='año')
+          .sort_index()) / 1000   # miles → millones
 
-# ── 3. Componentes y estadísticas ───────────────────────────────────
+# ─────────────────────────────────────────────────────────────────────
+# Componentes, columnas y abreviaturas
+# ─────────────────────────────────────────────────────────────────────
 componentes = [
     ("gastos_consumo",               "Consumo total"),
     ("formacion_capital",            "Inversión"),
@@ -58,148 +53,133 @@ componentes = [
     ("consumo_privado",              "Consumo privado"),
     ("consumo_publico",              "Consumo público"),
 ]
+cols_componentes = [col for col, _ in componentes]
 
-def cuadro_stats(sub, a, b):
-    lines = []
-    for col,label in componentes:
-        μ    = sub[col].mean()
-        Δpct = (df.loc[b,col] - df.loc[a,col]) / df.loc[a,col] * 100
-        lines.append(f"{label}: μ={μ:,.0f}  Δ{b}/{a}={Δpct:.1f}%")
-    return "\n".join(lines)
-
-def calcular_tasa_de_crecimiento(df,valor_final,valor_inicial,columna):
-    return int(((df.loc[valor_final, columna]/df.loc[valor_inicial, columna]-1)*100).round(0))
-
-txt_cr = "Crisis 52-56\n" + cuadro_stats(df.loc[1952:1956], 1952, 1956)
-txt_po = "Post-crisis 56-82\n" + cuadro_stats(df.loc[1956:1982], 1956, 1982)
-#estadisticas
-avg_expansion_50_70   = df.loc[EXPANSION_50_70].mean().to_dict()
-avg_recesion_71_84    = df.loc[RECESION_71_84].mean().to_dict()
-avg_expansion_85_05   = df.loc[EXPANSION_85_05].mean().to_dict()
-avg_expansion_06_14 = df.loc[ACUMULACION_06_14].mean().to_dict()
-avg_recesion_15_23    = df.loc[RECESION_15_23].mean().to_dict()
-
-tasa_1970_1956 = calcular_tasa_de_crecimiento(df, 1970, 1956, 'pib_real_base_1990')
-tasa_1986_1970 = calcular_tasa_de_crecimiento(df, 1986, 1970, 'pib_real_base_1990')
-tasa_2006_1986 = calcular_tasa_de_crecimiento(df, 2006, 1986, 'pib_real_base_1990')
-tasa_2014_2006 = calcular_tasa_de_crecimiento(df, 2014, 2006, 'pib_real_base_1990')
+abbr = {
+    "gastos_consumo":               "CT",
+    "formacion_capital":            "Inv",
+    "exportacion_bienes_servicios": "X",
+    "importacion_bienes":           "M",
+    "pib_real_base_1990":           "PIB",
+    "consumo_privado":              "Cp",
+    "consumo_publico":              "Cg",
+}
 
+# ─────────────────────────────────────────────────────────────────────
+# Preparación
+# ─────────────────────────────────────────────────────────────────────
+annot_years   = adjust_annot_years(df, annot_years_sin_crisis)
+periodos      = adjust_periods(df, periodos_tasas_sin_crisis)
 
-# ── 4. Configuración de hitos y anotaciones ────────────────────────
-# Años donde dibujaremos líneas verticales
-hitos_v = {
-    1950: "Expansion",
-    1971: "Recesion",
-    1985: "Expansion",
-    2005: "Expansion",
-    2015: "Recesion"
+# Estadísticas por ciclo
+cycle_stats = {
+    name: df.loc[period, cols_componentes].mean().to_dict()
+    for name, period in CYCLES_SIN_CRISIS.items()
 }
 
-# Años que queremos anotar en todas las series
-anot_years = [1950,1971,1985, 2005, 2015, 2023]
+# Paleta de colores
+cmap = plt.get_cmap("tab10")
+component_colors = {
+    "gastos_consumo":               cmap(4),
+    "formacion_capital":            cmap(1),
+    "exportacion_bienes_servicios": cmap(2),
+    "importacion_bienes":           cmap(3),
+    "pib_real_base_1990":           cmap(0),
+    "consumo_privado":              cmap(5),
+    "consumo_publico":              cmap(6),
+}
 
-# ── Offsets personalizados para cada componente y año ──────────────
+# ─────────────────────────────────────────────────────────────────────
+# Offsets
+# ─────────────────────────────────────────────────────────────────────
 annotation_offsets = {
     'gastos_consumo': {
-        1950: (-0.8,  3800), 1971: (1.5, 4900), 1985: (-0.5,  6000),
-        2005: (-1.2,  6000), 2015: (1.38,   5200),2023: (1.2, 1300),
+        1950: (-0.8, 3800), 1971: (1.5, 4900), 1985: (-0.5, 6000),
+        2005: (-1.2, 6000), 2015: (1.38, 5200), 2023: (1.2, 1300),
     },
     'formacion_capital': {
-        1950: (-1.5, -6100), 1971: (1.5, -6100), 1985: (-1.5,  -6100),
-        2005: (-1.5,  -4500), 2015: (1.5,  -6100), 2023: (1.2, -1100),
+        1950: (-1.5, -6100), 1971: (1.5, -6100), 1985: (-1.5, -6100),
+        2005: (-1.5, -4500), 2015: (1.5, -6100), 2023: (1.2, -1100),
     },
     'exportacion_bienes_servicios': {
-        1950: (-3,  -3000), 1971: (3, -3000), 1985: (-3, -3000),
-        2005: (-1.9,    0), 2015: (2,   3000),2023: (1.2, -900),
+        1950: (-3, -3000), 1971: (3, -3000), 1985: (-3, -3000),
+        2005: (-1.9, 0), 2015: (0, 3000), 2023: (1.2, -900),
     },
     'importacion_bienes': {
         1950: (-2, -4600), 1971: (2, -4600), 1985: (-2, -4600),
-        2005: (-2, -6500), 2015: (2,   -6500),2023: (1.2, 1000),
+        2005: (-2, -6500), 2015: (2, -6500), 2023: (1.9, 1000),
     },
     'pib_real_base_1990': {
-        1950: (-0.8,  4900), 1971: (2, 5900), 1985: (-0.5,  6300),
-        2005: (-1.2,  5500), 2015: (0.7,    5500),2023: (1.2, 1200),
+        1950: (-0.8, 4900), 1971: (2, 5900), 1985: (-0.5, 6300),
+        2005: (-1.2, 5500), 2015: (0.7, 5500), 2023: (1.2, 1200),
     },
     'consumo_privado': {
-        1950: (-2, 2500), 1971: (-2.3, 6200), 1985: (-0.5,  5100),
-        2005: (-1.2,  4900), 2015: (1,   -1900),2023: (1.2,  800),
+        1950: (-2, 2500), 1971: (-2.3, 6200), 1985: (-0.5, 5100),
+        2005: (-1.2, 4900), 2015: (1, -1900), 2023: (1.2, 800),
     },
     'consumo_publico': {
-        1950: (-0.8, -7000), 1971: (0.8, -7100), 1985: (-0.8,  -7100),
-        2005: (-0.8, -7000), 2015: (0.8,    -7000),2023: (1.2,  600)
+        1950: (-0.8, -7000), 1971: (0.8, -7100), 1985: (-0.8, -7100),
+        2005: (-0.8, -7000), 2015: (0.8, -7000), 2023: (1.2, 600),
     },
 }
-hitos_offset = {
-    1950: 0.45, 1971: 0.5, 1985: 0.5,
-    2005: 0.70, 2015: 0.55,
-}
-period_offsets: dict[str, tuple[float, float]] = {
-    '1950-1970': (1960, 0.49),
-    '1971-1984': (1972, 0.49),
-    '1985-2005': (1990, 0.56),
-    '2006-2014': (2006, 0.01),
-    '2015-2023': (2018, 0.01),
-}
-# ── 8.4 Ubicación de cuadros dentro de la gráfica ─────────────────────────
 
-cmap = plt.get_cmap("tab10")
+hitos_offset = {1950: 0.45, 1971: 0.50, 1985: 0.50, 2005: 0.70, 2015: 0.55}
 
-component_colors = {
-    "gastos_consumo":               cmap(4),  # azul     → CT  
-    "formacion_capital":            cmap(1),  # naranja  → Inv  
-    "exportacion_bienes_servicios": cmap(2),  # verde    → X  
-    "importacion_bienes":           cmap(3),  # rojo     → M  
-    "pib_real_base_1990":           cmap(0),  # morado   → PIB  
-    "consumo_privado":              cmap(5),  # marrón   → Cp  
-    "consumo_publico":              cmap(6),  # rosa     → Cg  
+text_offsets = {
+    "Expansión 50-70": (1960, 0.85),
+    "Recesión 71-84":  (1972, 0.98),
+    "Expansión 85-05": (1990, 0.98),
+    "Expansión 06-14": (2006.3, 0.98),
+    "Recesión 15-22":  (2018, 0.60),
 }
-# ── 5. Crear figura y trazar ────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15,8))
 
-for i,(col,label) in enumerate(componentes):
-    ax.plot(df.index, df[col], label=label, color=component_colors[col])
+period_offsets = {
+    '1950-1970': (1960, 0.58),
+    '1971-1984': (1972, 0.71),
+    '1985-2005': (1990, 0.71),
+    '2006-2014': (2006, 0.71),
+    '2015-2023': (2018, 0.35),
+}
 
-# ── 6. Dibujar líneas verticales de hitos ───────────────────────────
-add_hitos(ax, df.index, hitos_v, hitos_offset)
-#7 anotaciones
-add_year_value_annotations(
-    ax,
-    df,
-    years=anot_years,
-    columnas=[col for col, _ in componentes],
-    annotation_offsets=annotation_offsets,
+participation_offsets = {
+    "1950-1970": (1960, 0.50),
+    "1971-1984": (1972, 0.63),
+    "1985-2005": (1990, 0.63),
+    "2006-2014": (2006, 0.05),
+    "2015-2022": (2018, 0.10),
+}
+
+# ─────────────────────────────────────────────────────────────────────
+# Gráfica
+# ─────────────────────────────────────────────────────────────────────
+fig, ax = init_base_plot(
+    df=df,
+    series=componentes,
     colors=component_colors,
-    arrow_lw=0.2
+    title=f"PIB y Componentes ({df.index[0]}–{df.index[-1]})",
+    xlabel="Año",
+    ylabel="Millones de bolivianos · 1990",
+    source_text="Fuente: Elaboración propia con datos de UDAPE"
 )
 
-# Mapa de tasas por año final
-periodos = [
-    (1950, 1970),
-    (1971, 1984),
-    (1985, 2005),
-    (2006, 2014),
-    (2015, 2023),
-]
-
+# Hitos verticales
+add_hitos(ax, df.index, hitos_v_sin_crisis, hitos_offset)
 
+# Anotaciones de valores por año
+add_year_value_annotations(
+    ax, df, annot_years, cols_componentes,
+    annotation_offsets, component_colors, arrow_lw=0.2
+)
 
-# ── 8. Cuadros de estadísticas ───────────────────────────────────────
-ybox = df.values.max() * 1.05
-ax.text(df.index[0], ybox, txt_cr,
-        fontsize=10, va='top', bbox=dict(facecolor='white', alpha=0.9))
-ax.text(df.index[-1] - (df.index[-1]-df.index[0])*0.3, ybox, txt_po,
-        fontsize=10, va='top', bbox=dict(facecolor='white', alpha=0.9))
-# ── 8.1 Diccionario de abreviaturas ─────────────────────────────────────
-abbr = {
-    "gastos_consumo":               "CT",
-    "formacion_capital":            "Inv",
-    "exportacion_bienes_servicios": "X",
-    "importacion_bienes":           "M",
-    "pib_real_base_1990":           "PIB",
-    "consumo_privado":              "Cp",
-    "consumo_publico":              "Cg",
-}
+# Cuadros de medias por ciclo
+y_max = ax.get_ylim()[1]
+line_spacing = y_max * 0.03
+add_cycle_means_multi(
+    ax, cycle_stats, text_offsets,
+    abbr, component_colors, line_spacing
+)
 
+# Tasas de crecimiento por periodo (solo PIB real)
 add_period_growth_annotations_multi(
     ax, df, periodos,
     cols=['pib_real_base_1990'],
@@ -207,72 +187,27 @@ add_period_growth_annotations_multi(
     colors=component_colors,
     abbr_map={'pib_real_base_1990': 'PIB'},
 )
-# ── 8.2 Estadísticas (promedios enteros) por ciclo ya calculado ─────────
-cycle_stats = {
-    "Expansión 50-70":   avg_expansion_50_70,
-    "Recesión 71-84":   avg_recesion_71_84,
-    "Expansión 85-05":   avg_expansion_85_05,
-    "Expansión 06-14":  avg_expansion_06_14,
-    "Recesión 15-23":   avg_recesion_15_23,
-}
-
-
-
-# offsets top-left de cada cuadro: (x_data, y_data)
-text_offsets = {
-    "Expansión 50-70": (1960, 0.75),
-    "Recesión 71-84":  (1972, 0.75),
-    "Expansión 85-05": (1990, 0.82),
-    "Expansión 06-14": (2006.3, 0.95),
-    "Recesión 15-23":  (2018, 0.57),
-}
-
-# ── 8.4 Ubicar y colorear estadísticas dentro de la gráfica ────────────
-y_max = ax.get_ylim()[1]
-# distancia vertical entre líneas de texto (en unidades de datos)
-line_spacing = y_max * 0.030
-
-
-add_cycle_means_multi(
-    ax,
-    cycle_stats,
-    text_offsets,
-    abbr_map=abbr,
-    colors=component_colors,
-    line_spacing=line_spacing
-)
-# ── 9. Formato final ────────────────────────────────────────────────
-ax.set_title(f"PIB y Componentes ({df.index[0]}–{df.index[-1]})", fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=2)
-ax.set_ylim(-7000, df.max().max() * 1.05)
 
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
+# Cuadros de participación por ciclo
+add_participation_cycle_boxes(
+    ax, df, periodos,
+    ['gastos_consumo', 'formacion_capital', 'exportacion_bienes_servicios',
+     'importacion_bienes', 'consumo_privado', 'consumo_publico'],
+    'pib_real_base_1990',
+    participation_offsets, abbr, component_colors
 )
+ax.set_ylim(-9000, df.max().max() * 1.05)
 
-plt.tight_layout()
-plt.savefig(os.path.join(output_dir, "pib_componentes_1.png"))
+plt.savefig(os.path.join(output_dir, "pib_componentes_1.1.png"))
 plt.show()
 
 
 
 # %%
-PERIODO_1 = slice(1950, 1984)   # Crisis
-PERIODO_2 = slice(1985, 2005)   # Expansión
-PERIODO_3 = slice(2006, 2023)   # Recesión
-
-#estadisticas
-avg_periodo_1   = df.loc[PERIODO_1].mean().to_dict()
-avg_periodo_2    = df.loc[PERIODO_2].mean().to_dict()
-avg_periodo_3   = df.loc[PERIODO_3].mean().to_dict()
+cycle_stats = {
+    name: df.loc[period].mean().to_dict()
+    for name, period in CYCLES_PERIODOS.items()
+}
 # ── 4. Configuración de hitos y anotaciones ────────────────────────
 # Años donde dibujaremos líneas verticales
 hitos_v = {
@@ -333,15 +268,20 @@ hitos_offset = {
     1950: 0.45, 1985: 0.5, 2006: 0.5,
     2022: 0.70,
 }
+text_offsets = {
+    "1950-1984": (1960, 0.85),
+    "1985-2005":  (1994, 0.75),
+    "2006-2022": (2018, 0.57),
+}
 period_offsets: dict[str, tuple[float, float]] = {
-    '1950-1984': (1960, 0.49),
+    '1950-1984': (1960, 0.55),
     '1985-2005': (1994, 0.49),
     '2006-2022': (2018, 0.01),
 }
-text_offsets = {
-    "1950-1984": (1960, 0.75),
-    "1985-2005":  (1994, 0.75),
-    "2006-2023": (2018, 0.57),
+participation_offsets = {
+    "1950-1984": (1960, 0.50),
+    "1985-2005": (1988, 0.56),
+    "2006-2022": (2009.1, 0.15),
 }
 # ── 8.4 Ubicación de cuadros dentro de la gráfica ─────────────────────────
 
@@ -357,11 +297,15 @@ component_colors = {
     "consumo_publico":              cmap(6),  # rosa     → Cg  
 }
 # ── 5. Crear figura y trazar ────────────────────────────────────────
-fig, ax = plt.subplots(figsize=(15,8))
-
-for i,(col,label) in enumerate(componentes):
-    ax.plot(df.index, df[col], label=label, color=component_colors[col])
-
+fig, ax = init_base_plot(
+    df=df,
+    series=componentes,
+    colors=component_colors,
+    title=f"PIB y Componentes ({df.index[0]}–{df.index[-1]})",
+    xlabel="Año",
+    ylabel="Millones de bolivianos · 1990",
+    source_text="Fuente: Elaboración propia con datos de UDAPE"
+)
 # ── 6. Dibujar líneas verticales de hitos ───────────────────────────
 add_hitos(ax, df.index, hitos_v, hitos_offset)
 #7 anotaciones
@@ -375,21 +319,11 @@ add_year_value_annotations(
     arrow_lw=0.2
 )
 
-# Mapa de tasas por año final
-periodos = [
-    (1950, 1984),
-    (1985, 2005),
-    (2006, 2022),
-]
 
 
 
-# ── 8. Cuadros de estadísticas ───────────────────────────────────────
-ybox = df.values.max() * 1.05
-ax.text(df.index[0], ybox, txt_cr,
-        fontsize=10, va='top', bbox=dict(facecolor='white', alpha=0.9))
-ax.text(df.index[-1] - (df.index[-1]-df.index[0])*0.3, ybox, txt_po,
-        fontsize=10, va='top', bbox=dict(facecolor='white', alpha=0.9))
+
+
 # ── 8.1 Diccionario de abreviaturas ─────────────────────────────────────
 abbr = {
     "gastos_consumo":               "CT",
@@ -402,18 +336,13 @@ abbr = {
 }
 
 add_period_growth_annotations_multi(
-    ax, df, periodos,
+    ax, df, periodos_tasas_periodos,
     cols=['pib_real_base_1990'],
     period_offsets=period_offsets,
     colors=component_colors,
     abbr_map={'pib_real_base_1990': 'PIB'},
 )
-# ── 8.2 Estadísticas (promedios enteros) por ciclo ya calculado ─────────
-cycle_stats = {
-    "1950-1984":   avg_periodo_1,
-    "1985-2005":   avg_periodo_2,
-    "2006-2023":   avg_periodo_3,
-}
+
 
 # ── 8.4 Ubicar y colorear estadísticas dentro de la gráfica ────────────
 y_max = ax.get_ylim()[1]
@@ -429,23 +358,23 @@ add_cycle_means_multi(
     colors=component_colors,
     line_spacing=line_spacing
 )
-# ── 9. Formato final ────────────────────────────────────────────────
-ax.set_title(f"PIB y Componentes ({df.index[0]}–{df.index[-1]})", fontweight='bold')
-ax.set_xlabel("Año")
-ax.set_ylabel("Millones de bolivianos · 1990")
-ax.set_xticks(df.index[::max(1,len(df)//31)])
-ax.tick_params(axis='x', rotation=45)
-ax.legend(loc='upper left', ncol=2)
-ax.set_ylim(-7000, df.max().max() * 1.05)
-
-fig.text(
-    0.07, 0.005,
-    "Fuente: Elaboración propia con datos de UDAPE",
-    ha="left", va="bottom",
-    fontsize=12, color="black",
-    transform=fig.transFigure
+periodos_participacion = [
+    (1950, 1984),
+    (1985, 2005),
+    (2006, 2022),
+]
+add_participation_cycle_boxes(
+    ax,
+    df,
+    periodos_participacion,
+    [ 'gastos_consumo', 'formacion_capital', 'exportacion_bienes_servicios', 'importacion_bienes', 'consumo_privado', 'consumo_publico'],
+    'pib_real_base_1990',
+    participation_offsets,
+    abbr,
+    component_colors,
 )
 
+ax.set_ylim(-7000, df.max().max() * 1.05)
 plt.tight_layout()
 plt.savefig(os.path.join(output_dir, "pib_componentes_2.png"))
 plt.show()
